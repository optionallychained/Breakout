(()=>{"use strict";var e,t,r,n,o,i,a={6809:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorldManager=t.UIManager=t.TextureAtlas=t.TextManager=t.SystemBase=t.StateBase=t.VertexShader=t.ShaderProgram=t.FragmentShader=t.UniformVariation=t.UniformType=t.ShaderVariableResolver=t.Renderer=t.Vec4=t.Vec3=t.Vec2=t.Random=t.Mat4=t.Mat3=t.Color=t.Angle=t.Keys=t.InputManager=t.GLShape=t.Geometry=t.Entity=t.EntityManager=t.GameBase=t.AuraError=t.Texture=t.Shader=t.MultiColor=t.Model=t.FlatColor=t.Component=t.CameraBase=void 0;var n=r(6679);Object.defineProperty(t,"CameraBase",{enumerable:!0,get:function(){return n.CameraBase}});var o=r(3631);Object.defineProperty(t,"Component",{enumerable:!0,get:function(){return o.Component}});var i=r(983);Object.defineProperty(t,"FlatColor",{enumerable:!0,get:function(){return i.FlatColor}});var a=r(9468);Object.defineProperty(t,"Model",{enumerable:!0,get:function(){return a.Model}});var s=r(6752);Object.defineProperty(t,"MultiColor",{enumerable:!0,get:function(){return s.MultiColor}});var c=r(604);Object.defineProperty(t,"Shader",{enumerable:!0,get:function(){return c.Shader}});var l=r(3111);Object.defineProperty(t,"Texture",{enumerable:!0,get:function(){return l.Texture}});var u=r(2189);Object.defineProperty(t,"AuraError",{enumerable:!0,get:function(){return u.AuraError}});var f=r(504);Object.defineProperty(t,"GameBase",{enumerable:!0,get:function(){return f.GameBase}});var d=r(1241);Object.defineProperty(t,"EntityManager",{enumerable:!0,get:function(){return d.EntityManager}});var p=r(2182);Object.defineProperty(t,"Entity",{enumerable:!0,get:function(){return p.Entity}});var h=r(520);Object.defineProperty(t,"Geometry",{enumerable:!0,get:function(){return h.Geometry}});var y=r(9919);Object.defineProperty(t,"GLShape",{enumerable:!0,get:function(){return y.GLShape}});var v=r(6163);Object.defineProperty(t,"InputManager",{enumerable:!0,get:function(){return v.InputManager}});var m=r(5179);Object.defineProperty(t,"Keys",{enumerable:!0,get:function(){return m.Keys}});var _=r(137);Object.defineProperty(t,"Angle",{enumerable:!0,get:function(){return _.Angle}});var g=r(9076);Object.defineProperty(t,"Color",{enumerable:!0,get:function(){return g.Color}});var w=r(6024);Object.defineProperty(t,"Mat3",{enumerable:!0,get:function(){return w.Mat3}});var b=r(9562);Object.defineProperty(t,"Mat4",{enumerable:!0,get:function(){return b.Mat4}});var E=r(9170);Object.defineProperty(t,"Random",{enumerable:!0,get:function(){return E.Random}});var T=r(6042);Object.defineProperty(t,"Vec2",{enumerable:!0,get:function(){return T.Vec2}});var x=r(1502);Object.defineProperty(t,"Vec3",{enumerable:!0,get:function(){return x.Vec3}});var O=r(2467);Object.defineProperty(t,"Vec4",{enumerable:!0,get:function(){return O.Vec4}});var P=r(1125);Object.defineProperty(t,"Renderer",{enumerable:!0,get:function(){return P.Renderer}});var C=r(8922);Object.defineProperty(t,"ShaderVariableResolver",{enumerable:!0,get:function(){return C.ShaderVariableResolver}});var S=r(2371);Object.defineProperty(t,"UniformType",{enumerable:!0,get:function(){return S.UniformType}});var A=r(3013);Object.defineProperty(t,"UniformVariation",{enumerable:!0,get:function(){return A.UniformVariation}});var M=r(8423);Object.defineProperty(t,"FragmentShader",{enumerable:!0,get:function(){return M.FragmentShader}});var R=r(7691);Object.defineProperty(t,"ShaderProgram",{enumerable:!0,get:function(){return R.ShaderProgram}});var j=r(8235);Object.defineProperty(t,"VertexShader",{enumerable:!0,get:function(){return j.VertexShader}});var I=r(8092);Object.defineProperty(t,"StateBase",{enumerable:!0,get:function(){return I.StateBase}});var N=r(5761);Object.defineProperty(t,"SystemBase",{enumerable:!0,get:function(){return N.SystemBase}});var V=r(8442);Object.defineProperty(t,"TextManager",{enumerable:!0,get:function(){return V.TextManager}});var F=r(1422);Object.defineProperty(t,"TextureAtlas",{enumerable:!0,get:function(){return F.TextureAtlas}});var G=r(7523);Object.defineProperty(t,"UIManager",{enumerable:!0,get:function(){return G.UIManager}});var U=r(4842);Object.defineProperty(t,"WorldManager",{enumerable:!0,get:function(){return U.WorldManager}})},845:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4499:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;var i=r(6994),a=r(2189),s=r(6024),c=r(6042),l=function(e){function t(t){var r,n,o=e.call(this,t)||this;return o.projection=s.Mat3.projection(t.projection.width,t.projection.height),o.transform=new i.Transform(null===(r=null==t?void 0:t.offset)||void 0===r?void 0:r.position,new c.Vec2(1,1),null===(n=null==t?void 0:t.offset)||void 0===n?void 0:n.angle),o}return o(t,e),t.prototype.attachTo=function(e,t){var r,n,o,i,s;try{this.following={transform:e.getComponent("Transform"),rules:{position:{x:null===(n=null===(r=null==t?void 0:t.position)||void 0===r?void 0:r.x)||void 0===n||n,y:null===(i=null===(o=null==t?void 0:t.position)||void 0===o?void 0:o.y)||void 0===i||i},angle:null!==(s=null==t?void 0:t.angle)&&void 0!==s&&s}}}catch(t){throw new a.AuraError({class:"Camera",method:"attachTo",message:"Failed to attach to Entity with tag ".concat(e.tag," : the Entity lacks a Transform2D")})}},t.prototype.getViewMatrix=function(){var e,t;return this.following?(t=s.Mat3.translate(new s.Mat3,this.actualPosition()),t=s.Mat3.rotate(t,this.actualAngle()),t=s.Mat3.scale(t,this.transform.scale)):t=this.transform.compute(),null!==(e=s.Mat3.invert(t))&&void 0!==e?e:t},t.prototype.moveRight=function(e){this.transform.moveRight(e)},t.prototype.moveUp=function(e){this.transform.moveUp(e)},t.prototype.move=function(e){e.x&&this.moveRight(e.x),e.y&&this.moveUp(e.y)},t.prototype.translate=function(e){this.transform.translate(e)},t.prototype.rotate=function(e){this.transform.rotate(e)},t.prototype.zoom=function(e){this.transform.scaleBy(e)},t.prototype.zoomTo=function(e){this.transform.scaleTo(e)},t.prototype.actualPosition=function(){var e=this.transform.position;if(this.following){var t=this.following,r=t.transform,n=t.rules,o=new c.Vec2(n.position.x?r.position.x:0,n.position.y?r.position.y:0);e=c.Vec2.add(e,o)}return e},t.prototype.actualAngle=function(){var e=this.transform.angle;return this.following&&(e+=this.following.transform.angle*(this.following.rules.angle?1:0)),e},t}(r(6679).CameraBase);t.Camera=l},6679:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CameraBase=void 0;var r=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.config.name},enumerable:!1,configurable:!0}),e.prototype.detach=function(){this.following=void 0},e.prototype.reset=function(){this.transform.reset()},e}();t.CameraBase=r},6810:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.BoxCollider=void 0;var i=function(e){function t(t){var r=e.call(this,"BoxCollider")||this;return r.dimensions=t,r}return o(t,e),t}(r(3631).Component);t.BoxCollider=i},6994:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Transform=void 0;var i=r(6024),a=r(6042),s=function(e){function t(t,r,n,o){void 0===t&&(t=new a.Vec2),void 0===r&&(r=new a.Vec2(1,1)),void 0===n&&(n=0),void 0===o&&(o=new a.Vec2);var i=e.call(this,"Transform")||this;return i.initialPosition=t,i.initialScale=r,i.initialAngle=n,i.velocity=o,i.position=new a.Vec2,i.up=new a.Vec2(0,1),i.right=new a.Vec2(1,0),i.scale=new a.Vec2(1,1),i.angle=0,i.translate(t),i.scaleTo(r),i.rotate(n),i}return o(t,e),t.prototype.moveRight=function(e){this.mutable.position=a.Vec2.add(this.position,a.Vec2.scale(this.right,e))},t.prototype.moveUp=function(e){this.mutable.position=a.Vec2.add(this.position,a.Vec2.scale(this.up,e))},t.prototype.move=function(e){e.x&&this.moveRight(e.x),e.y&&this.moveUp(e.y)},t.prototype.translate=function(e){this.mutable.position=a.Vec2.add(this.position,e)},t.prototype.rotate=function(e){this.mutable.angle+=e;var t=i.Mat3.fromRotation(e);this.mutable.up=a.Vec2.normalize(a.Vec2.transformByMat3(this.up,t)),this.mutable.right=a.Vec2.normalize(a.Vec2.transformByMat3(this.right,t))},t.prototype.scaleBy=function(e){this.mutable.scale=a.Vec2.mult(this.scale,e)},t.prototype.scaleTo=function(e){this.mutable.scale=e},t.prototype.reset=function(){this.mutable.right=new a.Vec2(1,0),this.mutable.up=new a.Vec2(0,1),this.mutable.angle=0,this.mutable.position=new a.Vec2,this.mutable.scale=new a.Vec2(1,1),this.translate(this.initialPosition),this.scaleTo(this.initialScale),this.rotate(this.initialAngle)},t.prototype.compute=function(){var e=i.Mat3.translate(new i.Mat3,this.position);return e=i.Mat3.rotate(e,this.angle),i.Mat3.scale(e,this.scale)},Object.defineProperty(t.prototype,"mutable",{get:function(){return this},enumerable:!1,configurable:!0}),t}(r(3631).Component);t.Transform=s},3631:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;t.Component=function(e){this.name=e}},983:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.FlatColor=void 0;var i=r(9076),a=function(e){function t(t){void 0===t&&(t=i.Color.white());var r=e.call(this,"FlatColor")||this;return r.color=t,r}return o(t,e),t}(r(3631).Component);t.FlatColor=a},9468:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var i=function(e){function t(t){var r=e.call(this,"Model")||this;return r.geometry=t,r}return o(t,e),Object.defineProperty(t.prototype,"modelName",{get:function(){return this.geometry.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertices",{get:function(){return this.geometry.vertices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertexSize",{get:function(){return this.geometry.vertexSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertexCount",{get:function(){return this.geometry.vertexCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"glShape",{get:function(){return this.geometry.glShape},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textureCoordinates",{get:function(){return this.geometry.textureCoordinates},enumerable:!1,configurable:!0}),t}(r(3631).Component);t.Model=i},6752:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.MultiColor=void 0;var i=function(e){function t(t){var r=e.call(this,"MultiColor")||this;return r.colors=t,r.currentColor=0,r}return o(t,e),t.prototype.nextColor=function(){var e=this.colors[this.currentColor++];return this.currentColor===this.colors.length&&(this.currentColor=0),e},t}(r(3631).Component);t.MultiColor=i},604:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=void 0;var i=function(e){function t(t){var r=e.call(this,"Shader")||this;return r.program=t,r}return o(t,e),Object.defineProperty(t.prototype,"programName",{get:function(){return this.program.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertex",{get:function(){return this.program.vertex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fragment",{get:function(){return this.program.fragment},enumerable:!1,configurable:!0}),t}(r(3631).Component);t.Shader=i},3111:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Texture=void 0;var i=function(e){function t(t,r,n,o){void 0===n&&(n=1),void 0===o&&(o=1);var i=e.call(this,"Texture")||this;return i.column=t,i.row=r,i.columnSpan=n,i.rowSpan=o,i}return o(t,e),t}(r(3631).Component);t.Texture=i},6476:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var a=r(7454),s=r(6042),c=r(2280),l=r(7057),u=function(e){function t(t){var r,n,o,i,u,f,d,p,h,y,v,m,_,g,w,b=e.call(this,t)||this;return b.states=new Map,b.systems=new Map,b.text=new a.Text({renderer:b.renderer,charset:null!==(n=null===(r=null==t?void 0:t.text)||void 0===r?void 0:r.charset)&&void 0!==n?n:b.defaults.textCharset,textureAtlas:null!==(i=null===(o=null==t?void 0:t.text)||void 0===o?void 0:o.textureAtlas)&&void 0!==i?i:b.defaults.textAtlas}),b.ui=new c.UI({renderer:b.renderer,textureAtlas:null===(u=null==t?void 0:t.ui)||void 0===u?void 0:u.textureAtlas}),b.world=new l.World({renderer:b.renderer,dimensions:null!==(d=null===(f=null==t?void 0:t.world)||void 0===f?void 0:f.dimensions)&&void 0!==d?d:new s.Vec2(null===(p=b.canvas)||void 0===p?void 0:p.width,null===(h=b.canvas)||void 0===h?void 0:h.height),textureAtlas:null===(y=null==t?void 0:t.world)||void 0===y?void 0:y.textureAtlas,camera:{offset:null===(m=null===(v=null==t?void 0:t.world)||void 0===v?void 0:v.camera)||void 0===m?void 0:m.offset,projection:null!==(w=null===(g=null===(_=null==t?void 0:t.world)||void 0===_?void 0:_.camera)||void 0===g?void 0:g.projection)&&void 0!==w?w:{width:b.canvas.width,height:b.canvas.height}}}),b.renderer.setRenderingMode("2D"),b}return o(t,e),t.prototype.addState=function(e){this.states.set(e.name,e)},t.prototype.addStates=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var o=i(r),a=o.next();!a.done;a=o.next()){var s=a.value;this.addState(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},t.prototype.addSystem=function(e){this.systems.set(e.name,e)},t.prototype.addSystems=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var o=i(r),a=o.next();!a.done;a=o.next()){var s=a.value;this.addSystem(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},t.prototype.initState=function(){var e;null===(e=this.currentState)||void 0===e||e.init(this)},t.prototype.endState=function(){var e;null===(e=this.currentState)||void 0===e||e.end(this)},t.prototype.update=function(){var e,t=this;this.systems.forEach((function(e){e.tick(t,t.frameDelta)})),null===(e=this.currentState)||void 0===e||e.tick(this,this.frameDelta)},t}(r(504).GameBase);t.Game=u},2189:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AuraError=void 0;var o=function(e){function t(t){var r=e.call(this,"".concat(t.method,"() -> ").concat(t.message))||this;return r.name="".concat(t.class," Error"),r}return n(t,e),t}(Error);t.AuraError=o},504:function(e,t,r){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.GameBase=void 0;var o=r(6163),i=r(9076),a=r(6042),s=r(1125),c=r(1422),l=r(2189),u=function(){function e(e){var t,r,n,u,f,d;if(this.frameDelta=0,this.lastFrameTime=Date.now(),this.data=new Map,this.debugData={frameCount:0,fps:""},this.defaults={backgroundColor:i.Color.black(),canvasDimensions:new a.Vec2(window.innerWidth,window.innerHeight),canvasParent:document.body,controlScheme:"keyboard",textCharset:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","(",")","[","]","+","-","*","/","!","?","'",'"',"#","Â£","$","&","%","^",",",".",":",";","<",">","_"," ","~","~"],textAtlas:new c.TextureAtlas("text","res/font.png",2048,32,64,1)},this.stopped=!1,null==e?void 0:e.canvasId){if(this.canvas=document.getElementById(e.canvasId),!this.canvas)throw new l.AuraError({class:"Game",method:"construct",message:"Failed to retrieve Canvas with id ".concat(e.canvasId)})}else this.canvas=document.createElement("canvas"),((null==e?void 0:e.canvasParent)?"string"==typeof e.canvasParent?document.getElementById(e.canvasParent):e.canvasParent:this.defaults.canvasParent).append(this.canvas);this.canvas.width=null!==(r=null===(t=null==e?void 0:e.canvasDimensions)||void 0===t?void 0:t.x)&&void 0!==r?r:this.defaults.canvasDimensions.x,this.canvas.height=null!==(u=null===(n=null==e?void 0:e.canvasDimensions)||void 0===n?void 0:n.y)&&void 0!==u?u:this.defaults.canvasDimensions.y,this.renderer=new s.Renderer(this,null!==(f=null==e?void 0:e.backgroundColor)&&void 0!==f?f:this.defaults.backgroundColor),this.input=new o.InputManager(this.canvas,null!==(d=null==e?void 0:e.controlScheme)&&void 0!==d?d:this.defaults.controlScheme),this.debugMode=null==e?void 0:e.debugMode,this.init=null==e?void 0:e.init}return e.prototype.switchToState=function(e){if(this.endState(),this.currentState=this.states.get(e),!this.currentState)throw new l.AuraError({class:"Game",method:"switchToState",message:"Failed to switch to State '".concat(e,"' : State does not exist")});this.initState()},e.prototype.removeSystem=function(e){this.systems.delete(e)},e.prototype.removeSystems=function(){for(var e,t,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];try{for(var i=n(r),a=i.next();!a.done;a=i.next()){var s=a.value;this.removeSystem(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.setData=function(e,t){this.data.set(e,t)},e.prototype.getData=function(e){var t=this.data.get(e);if(void 0===t)throw new l.AuraError({class:"Game",method:"getData",message:"Failed to retrieve data with key '".concat(e,"'")});return t},e.prototype.deleteData=function(e){this.data.delete(e)},e.prototype.registerShader=function(e){this.renderer.createShaderProgram(e)},e.prototype.start=function(e){var t;null===(t=this.init)||void 0===t||t.call(this),this.switchToState(e),this.run()},e.prototype.destroy=function(){var e;this.stopped=!0,this.renderer.destroy(),this.input.destroy(),null===(e=this.canvas)||void 0===e||e.remove(),this.canvas=void 0},e.prototype.run=function(){if(!this.stopped){var e=Date.now();this.frameDelta=e-this.lastFrameTime,this.lastFrameTime=e,this.update(),this.world.tick(this,this.frameDelta),this.ui.tick(this,this.frameDelta),this.text.tick(this,this.frameDelta),this.renderer.clearScreen(),this.world.render(),this.ui.render(),this.text.render(),this.debugMode&&(this.debugData.frameCount++,this.debugData.frameCount%10==0&&(this.debugData.frameCount=0,this.debugData.fps=(1e3/this.frameDelta).toFixed(1))),requestAnimationFrame(this.run.bind(this))}},e}();t.GameBase=u},2182:function(e,t,r){var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Entity=void 0;var a=r(2189),s=function(){function e(e){this.config=e,this.id=(+new Date).toString(16)+(1e7*Math.random()|0).toString(16),this.components=new Map,e.components&&this.addComponents.apply(this,o([],n(e.components),!1))}return Object.defineProperty(e.prototype,"tag",{get:function(){return this.config.tag},enumerable:!1,configurable:!0}),e.prototype.tick=function(e,t){},e.prototype.onCollisionStart=function(e,t){},e.prototype.onCollisionContinue=function(e,t){},e.prototype.onCollisionEnd=function(e,t){},e.prototype.getComponent=function(e){if(!this.hasComponent(e))throw new a.AuraError({class:"Entity",method:"getComponent",message:"Failed to retrieve Component ".concat(e," for Entity with tag ").concat(this.tag)});return this.components.get(e)},e.prototype.addComponent=function(e){this.components.set(e.name,e)},e.prototype.addComponents=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var o=i(r),a=o.next();!a.done;a=o.next()){var s=a.value;this.addComponent(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.removeComponent=function(e){this.components.delete(e)},e.prototype.removeComponents=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var o=i(r),a=o.next();!a.done;a=o.next()){var s=a.value;this.removeComponent(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.hasComponent=function(e){return this.components.has(e)},e.prototype.hasComponents=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var o=i(r),a=o.next();!a.done;a=o.next()){var s=a.value;if(!this.hasComponent(s))return!1}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return!0},e}();t.Entity=s},1241:function(e,t,r){var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityManager=void 0;var a=r(2189),s=r(8922),c=function(){function e(e){this.config=e,this.entities=[],this.renderableEntities=new Map,this.addList=[],this.removeList=[],this.vbos=new Map,this.entityFilterCache=new Map,this.sourcedEntityFilterCache=new Map,e.textureAtlas&&e.renderer.createTexture(e.textureAtlas)}return Object.defineProperty(e.prototype,"entityCount",{get:function(){return this.entities.length},enumerable:!1,configurable:!0}),e.prototype.addEntity=function(e){this.addList.push(e)},e.prototype.addEntities=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addList=this.addList.concat(e)},e.prototype.removeEntity=function(e){this.removeList.push(e)},e.prototype.removeEntities=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeList=this.removeList.concat(e)},e.prototype.clearEntities=function(){this.removeEntities.apply(this,o([],n(this.entities),!1)),this.cleanEntities(),this.invalidateFilterCaches()},e.prototype.tick=function(e,t){var r,n,o=this.loadEntities(),a=this.cleanEntities();(o||a)&&this.invalidateFilterCaches();try{for(var s=i(this.entities),c=s.next();!c.done;c=s.next())c.value.tick(e,t)}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}},e.prototype.render=function(){var e,t,r,o,a;try{for(var s=i(this.renderableEntities.entries()),c=s.next();!c.done;c=s.next()){var l=n(c.value,2),u=l[0],f=l[1];try{for(var d=(r=void 0,i(f)),p=d.next();!p.done;p=d.next()){var h=n(p.value,2),y=h[0],v=h[1],m=this.vbos.get("".concat(u,"_").concat(y));v.length&&m&&(this.config.renderer.render({vbo:m,shaderProgramName:u,textureAtlasName:null===(a=this.config.textureAtlas)||void 0===a?void 0:a.name,entities:v}),m.changed=!1)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}},e.prototype.filterEntitiesByComponentName=function(e){return this.memoizeFilter(e,(function(t){return t.hasComponent(e)}))},e.prototype.filterEntitiesByComponentNames=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.memoizeFilter(e.toString(),(function(t){return t.hasComponents.apply(t,o([],n(e),!1))}))},e.prototype.filterEntitiesByComponentNameFromSource=function(e,t,r){return this.memoizeFilter(r,(function(e){return e.hasComponent(r)}),t,e)},e.prototype.filterEntitiesByComponentNamesFromSource=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return this.memoizeFilter(r.toString(),(function(e){return e.hasComponents.apply(e,o([],n(r),!1))}),t,e)},e.prototype.filterEntitiesByTag=function(e){return this.memoizeFilter(e,(function(t){return t.tag===e}))},e.prototype.filterEntitiesByTags=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.memoizeFilter(e.toString(),(function(t){return e.includes(t.tag)}))},e.prototype.loadEntities=function(){var e,t;if(this.addList.length){var r=new Set;try{for(var n=i(this.addList),o=n.next();!o.done;o=n.next()){var a=o.value;if(a.hasComponent("Shader")&&a.hasComponent("Model")){var s=a.getComponent("Shader").programName,c=a.getComponent("Model").modelName;r.add("".concat(s,"-").concat(c));var l=this.renderableEntities.get(s);if(l){var u=l.get(c);u?u.push(a):u=[a],l.set(c,u)}else(l=new Map).set(c,[a]);this.renderableEntities.set(s,l)}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return this.compileVertices(r),this.entities=this.entities.concat(this.addList),this.addList=[],!0}return!1},e.prototype.cleanEntities=function(){var e,t;if(this.removeList.length){var r=new Set;try{for(var n=i(this.removeList),o=n.next();!o.done;o=n.next()){var a=o.value,s=this.entities.indexOf(a);if(!(s<0)&&(this.entities.splice(s,1),a.hasComponent("Shader")&&a.hasComponent("Model"))){var c=a.getComponent("Shader").programName,l=a.getComponent("Model").modelName,u=this.renderableEntities.get(c);if(u){var f=u.get(l);f&&(f.splice(f.indexOf(a),1),r.add("".concat(c,"-").concat(l)),f.length||u.delete(l),u.size||this.renderableEntities.delete(c))}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return this.compileVertices(r),this.removeList=[],!0}return!1},e.prototype.compileVertices=function(e){var t,r,n,o,c,l,u;try{for(var f=i(e),d=f.next();!d.done;d=f.next()){var p=d.value,h=p.substring(0,p.indexOf("-")),y=p.substring(p.indexOf("-")+1),v=null===(u=this.renderableEntities.get(h))||void 0===u?void 0:u.get(y),m="".concat(h,"_").concat(y),_="".concat(this.config.name,"_").concat(m);if(v&&v.length){this.vbos.get(m)||this.config.renderer.createVBO(_);var g=v[0].getComponent("Shader"),w=v[0].getComponent("Model"),b=w.glShape,E=w.vertexCount,T=Object.values(g.vertex.attributes).reduce((function(e,t){return{name:t.name,size:e.size+t.size}})).size,x=T*E,O=new Float32Array(v.length*x),P=0;try{for(var C=(n=void 0,i(v)),S=C.next();!S.done;S=C.next())for(var A=S.value,M=0,R=0,j=0;j<E;j++)try{for(var I=(c=void 0,i(g.vertex.attributes)),N=I.next();!N.done;N=I.next()){var V=N.value,F=s.ShaderVariableResolver.resolveAttribute(V.name,A);if("number"==typeof F)F=Float32Array.from([F]);else if("a_Position"===V.name)F=F.slice(M,M+V.size),M+=V.size;else if("a_TexCoord"===V.name){var G=this.config.textureAtlas;if(!G)throw new a.AuraError({class:"EntityManager",method:"compileVertices",message:"\n                                            Failed to render ".concat(this.config.name," Entity '").concat(A.tag,"' with texture shader: No Texture Atlas\n                                            was configured for ").concat(this.config.name," Entities\n                                        ")});var U=A.getComponent("Texture"),L=U.column,B=U.row,D=U.columnSpan,z=U.rowSpan;F=G.resolveTextureCoordinates(F.slice(R,R+2),L,B,D,z),R+=2}O.set(F,P),P+=V.size}}catch(e){c={error:e}}finally{try{N&&!N.done&&(l=I.return)&&l.call(I)}finally{if(c)throw c.error}}}catch(e){n={error:e}}finally{try{S&&!S.done&&(o=C.return)&&o.call(C)}finally{if(n)throw n.error}}this.vbos.set(m,{name:_,vertices:O,vertexCount:E,vertexSize:T,glShape:b,changed:!0})}else this.config.renderer.deleteVBO(_),this.vbos.delete(m)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(t)throw t.error}}},e.prototype.memoizeFilter=function(e,t,r,n){void 0===n&&(n=this.entities);var o=this.entityFilterCache;r&&(e="".concat(e,"_").concat(r),o=this.sourcedEntityFilterCache);var i=o.get(e);return i||(i=n.filter(t),o.set(e,i)),i},e.prototype.invalidateFilterCaches=function(){this.entityFilterCache.clear(),this.sourcedEntityFilterCache.clear()},e}();t.EntityManager=c},9014:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CIRCLE=void 0;var n=r(2494);t.CIRCLE=(0,n.POLYGON)(30,"circle")},6425:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.F=void 0;var n=r(520),o=r(9919);t.F=new n.Geometry({name:"f",vertices:Float32Array.from([-.5,-.5,-.25,-.5,-.25,.5,-.25,.5,-.5,.5,-.5,-.5,-.25,.25,.5,.25,.5,.5,.5,.5,-.25,.5,-.25,.25,-.25,-.15,.2,-.15,.2,.05,.2,.05,-.25,.05,-.25,-.15]),vertexSize:2,vertexCount:18,glShape:o.GLShape.TRIANGLES,textureCoordinates:Float32Array.from([])})},9872:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HEXAGON=void 0;var n=r(2494);t.HEXAGON=(0,n.POLYGON)(6,"hexagon")},5341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LINE=void 0;var n=r(520),o=r(9919);t.LINE=new n.Geometry({name:"line",vertices:Float32Array.from([-.5,0,.5,0]),vertexSize:2,vertexCount:2,glShape:o.GLShape.LINES,textureCoordinates:Float32Array.from([])})},4403:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OCTAGON=void 0;var n=r(2494);t.OCTAGON=(0,n.POLYGON)(8,"octagon")},8247:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PENTAGON=void 0;var n=r(520),o=r(9919);t.PENTAGON=new n.Geometry({name:"pentagon",vertices:Float32Array.from([-.3,-.5,.3,-.5,.5,.1,0,.5,-.5,.1]),vertexSize:2,vertexCount:5,glShape:o.GLShape.TRIANGLE_FAN,textureCoordinates:Float32Array.from([])})},9177:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.POINT=void 0;var n=r(520),o=r(9919);t.POINT=new n.Geometry({name:"point",vertices:Float32Array.from([0,0]),vertexSize:2,vertexCount:1,glShape:o.GLShape.POINTS,textureCoordinates:Float32Array.from([])})},2494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.POLYGON=void 0;var n=r(520),o=r(9919);t.POLYGON=function(e,t){for(var r=[],i=0;i<2*e;i+=2){var a=Math.PI*i/e;r.push(Math.cos(a)/2),r.push(Math.sin(a)/2)}return new n.Geometry({name:null!=t?t:"polygon_".concat(e),vertices:Float32Array.from(r),vertexSize:2,vertexCount:e,glShape:o.GLShape.TRIANGLE_FAN,textureCoordinates:Float32Array.from([])})}},4240:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SQUARE=void 0;var n=r(520),o=r(9919);t.SQUARE=new n.Geometry({name:"square",vertices:Float32Array.from([-.5,-.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5]),vertexSize:2,vertexCount:6,glShape:o.GLShape.TRIANGLES,textureCoordinates:Float32Array.from([0,0,1,0,1,1,1,1,0,1,0,0])})},1827:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TRIANGLE=void 0;var n=r(520),o=r(9919),i=Math.sqrt(3)/4;t.TRIANGLE=new n.Geometry({name:"triangle_equilateral",vertices:Float32Array.from([-.5,-i,.5,-i,0,i]),vertexSize:2,vertexCount:3,glShape:o.GLShape.TRIANGLES,textureCoordinates:Float32Array.from([0,0,1,0,.5,1])})},2540:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TRIANGLE_RIGHT_ANGLE=void 0;var n=r(520),o=r(9919);t.TRIANGLE_RIGHT_ANGLE=new n.Geometry({name:"triangle_right_angle",vertices:Float32Array.from([-.5,-.5,.5,-.5,-.5,.5]),vertexSize:2,vertexCount:3,glShape:o.GLShape.TRIANGLES,textureCoordinates:Float32Array.from([0,0,1,0,0,1])})},5460:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CIRCLE_WIREFRAME=void 0;var n=r(6617);t.CIRCLE_WIREFRAME=(0,n.POLYGON_WIREFRAME)(30,"circle_wireframe")},4636:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.F_WIREFRAME=void 0;var n=r(520),o=r(9919);t.F_WIREFRAME=new n.Geometry({name:"f_wireframe",vertices:Float32Array.from([-.5,-.5,-.25,-.5,-.25,-.15,.2,-.15,.2,.05,-.25,.05,-.25,.25,.5,.25,.5,.5,-.5,.5]),vertexSize:2,vertexCount:10,glShape:o.GLShape.LINE_LOOP,textureCoordinates:Float32Array.from([])})},9815:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HEXAGON_WIREFRAME=void 0;var n=r(6617);t.HEXAGON_WIREFRAME=(0,n.POLYGON_WIREFRAME)(6,"hexagon_wireframe")},7882:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OCTAGON_WIREFRAME=void 0;var n=r(6617);t.OCTAGON_WIREFRAME=(0,n.POLYGON_WIREFRAME)(8,"octagon_wireframe")},7095:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PENTAGON_WIREFRAME=void 0;var n=r(520),o=r(9919);t.PENTAGON_WIREFRAME=new n.Geometry({name:"pentagon_wireframe",vertices:Float32Array.from([-.3,-.5,.3,-.5,.5,.1,0,.5,-.5,.1]),vertexSize:2,vertexCount:5,glShape:o.GLShape.LINE_LOOP,textureCoordinates:Float32Array.from([])})},6617:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.POLYGON_WIREFRAME=void 0;var n=r(520),o=r(9919);t.POLYGON_WIREFRAME=function(e,t){for(var r=[],i=0;i<2*e;i+=2){var a=Math.PI*i/e;r.push(Math.cos(a)/2),r.push(Math.sin(a)/2)}return new n.Geometry({name:null!=t?t:"polygon_".concat(e,"_wireframe"),vertices:Float32Array.from(r),vertexSize:2,vertexCount:e,glShape:o.GLShape.LINE_LOOP,textureCoordinates:Float32Array.from([])})}},6687:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SQUARE_WIREFRAME=void 0;var n=r(520),o=r(9919);t.SQUARE_WIREFRAME=new n.Geometry({name:"square_wireframe",vertices:Float32Array.from([-.5,-.5,.5,-.5,.5,.5,-.5,.5]),vertexSize:2,vertexCount:4,glShape:o.GLShape.LINE_LOOP,textureCoordinates:Float32Array.from([])})},5459:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TRIANGLE_WIREFRAME=void 0;var n=r(520),o=r(9919),i=Math.sqrt(3)/4;t.TRIANGLE_WIREFRAME=new n.Geometry({name:"triangle_equilateral_wireframe",vertices:Float32Array.from([-.5,-i,.5,-i,0,i]),vertexSize:2,vertexCount:3,glShape:o.GLShape.LINE_LOOP,textureCoordinates:Float32Array.from([])})},8521:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TRIANGLE_RIGHT_ANGLE_WIREFRAME=void 0;var n=r(520),o=r(9919);t.TRIANGLE_RIGHT_ANGLE_WIREFRAME=new n.Geometry({name:"triangle_right_angle_wireframe",vertices:Float32Array.from([-.5,-.5,.5,-.5,-.5,.5]),vertexSize:2,vertexCount:3,glShape:o.GLShape.LINE_LOOP,textureCoordinates:Float32Array.from([])})},520:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Geometry=void 0;var r=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.config.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.config.vertices},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexSize",{get:function(){return this.config.vertexSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexCount",{get:function(){return this.config.vertexCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"glShape",{get:function(){return this.config.glShape},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textureCoordinates",{get:function(){return this.config.textureCoordinates},enumerable:!1,configurable:!0}),e}();t.Geometry=r},9919:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.GLShape=void 0,(r=t.GLShape||(t.GLShape={}))[r.POINTS=WebGLRenderingContext.POINTS]="POINTS",r[r.LINES=WebGLRenderingContext.LINES]="LINES",r[r.LINE_LOOP=WebGLRenderingContext.LINE_LOOP]="LINE_LOOP",r[r.LINE_STRIP=WebGLRenderingContext.LINE_STRIP]="LINE_STRIP",r[r.TRIANGLES=WebGLRenderingContext.TRIANGLES]="TRIANGLES",r[r.TRIANGLE_STRIP=WebGLRenderingContext.TRIANGLE_STRIP]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=WebGLRenderingContext.TRIANGLE_FAN]="TRIANGLE_FAN"},9323:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.VertexShaders=t.ShaderPrograms=t.FragmentShaders=t.Geometries=t.World=t.UI=t.Panel=t.System=t.Physics=t.Collision=t.State=t.Game=t.Transform=t.BoxCollider=t.Camera=void 0;var i=r(4499);Object.defineProperty(t,"Camera",{enumerable:!0,get:function(){return i.Camera}});var a=r(6810);Object.defineProperty(t,"BoxCollider",{enumerable:!0,get:function(){return a.BoxCollider}});var s=r(6994);Object.defineProperty(t,"Transform",{enumerable:!0,get:function(){return s.Transform}});var c=r(6476);Object.defineProperty(t,"Game",{enumerable:!0,get:function(){return c.Game}});var l=r(9014),u=r(6425),f=r(9872),d=r(5341),p=r(4403),h=r(8247),y=r(9177),v=r(2494),m=r(4240),_=r(1827),g=r(2540),w=r(5460),b=r(4636),E=r(9815),T=r(7882),x=r(7095),O=r(6617),P=r(6687),C=r(5459),S=r(8521),A=r(6628),M=r(2476),R=r(6190),j=r(4113),I=r(166),N=r(6758),V=r(377),F=r(2818),G=r(3673),U=r(178),L=r(1644),B=r(7389);Object.defineProperty(t,"State",{enumerable:!0,get:function(){return B.State}});var D=r(4676);Object.defineProperty(t,"Collision",{enumerable:!0,get:function(){return D.Collision}});var z=r(6864);Object.defineProperty(t,"Physics",{enumerable:!0,get:function(){return z.Physics}});var k=r(7669);Object.defineProperty(t,"System",{enumerable:!0,get:function(){return k.System}});var X=r(2038);Object.defineProperty(t,"Panel",{enumerable:!0,get:function(){return X.Panel}});var W=r(2280);Object.defineProperty(t,"UI",{enumerable:!0,get:function(){return W.UI}});var H=r(7057);Object.defineProperty(t,"World",{enumerable:!0,get:function(){return H.World}}),o(r(6809),t),o(r(845),t),t.Geometries={CIRCLE:l.CIRCLE,F:u.F,HEXAGON:f.HEXAGON,LINE:d.LINE,OCTAGON:p.OCTAGON,PENTAGON:h.PENTAGON,POINT:y.POINT,POLYGON:v.POLYGON,SQUARE:m.SQUARE,TRIANGLE:_.TRIANGLE,TRIANGLE_RIGHT_ANGLE:g.TRIANGLE_RIGHT_ANGLE,Wireframe:{CIRCLE:w.CIRCLE_WIREFRAME,F:b.F_WIREFRAME,HEXAGON:E.HEXAGON_WIREFRAME,OCTAGON:T.OCTAGON_WIREFRAME,PENTAGON:x.PENTAGON_WIREFRAME,POLYGON:O.POLYGON_WIREFRAME,SQUARE:P.SQUARE_WIREFRAME,TRIANGLE:C.TRIANGLE_WIREFRAME,TRIANGLE_RIGHT_ANGLE:S.TRIANGLE_RIGHT_ANGLE_WIREFRAME}},t.FragmentShaders={BASIC:A.FRAGMENT_BASIC,COLOR_PER_VERTEX:M.FRAGMENT_COLOR_PER_VERTEX,TEXTURE:R.FRAGMENT_TEXTURE,TEXTURE_COLORED:j.FRAGMENT_TEXTURE_COLORED},t.ShaderPrograms={BASIC:I.PROGRAM_BASIC,COLOR_PER_VERTEX:N.PROGRAM_COLOR_PER_VERTEX,TEXTURE:V.PROGRAM_TEXTURE,TEXTURE_COLORED:F.PROGRAM_TEXTURE_COLORED},t.VertexShaders={BASIC:G.VERTEX_BASIC,COLOR_PER_VERTEX:U.VERTEX_COLOR_PER_VERTEX,TEXTURE:L.VERTEX_TEXTURE}},6163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputManager=void 0;var n=r(6042),o=r(5179),i=function(){function e(e,t){switch(this.controlScheme=t,this.mousePos=new n.Vec2,this.clickPos=new n.Vec2,this.dblClickPos=new n.Vec2,this.contextClickPos=new n.Vec2,this.keyBuffer=new Set,this.mousePressed=!1,this.ignoreKeys=[o.Keys.F_5,o.Keys.F_12],this.boundHandlers={onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this),onClick:this.onClick.bind(this),onContextMenu:this.onContextMenu.bind(this),onDoubleClick:this.onDoubleClick.bind(this),onMouseMove:this.onMouseMove.bind(this)},this.canvas=e,t){case"keyboard":this.setupKeyboard();break;case"mouse":this.setupMouse(e);break;default:this.setupMouse(e),this.setupKeyboard()}}return e.prototype.isKeyDown=function(e){return this.keyBuffer.has(e)},e.prototype.isMouseDown=function(){return this.mousePressed},e.prototype.destroy=function(){switch(this.controlScheme){case"keyboard":this.tearDownKeyboard();break;case"mouse":this.tearDownMouse(this.canvas);break;default:this.tearDownMouse(this.canvas),this.tearDownKeyboard()}this.canvas=void 0},e.prototype.onKeyDown=function(e){var t=e.code;e.preventDefault(),this.ignoreKeys.includes(t)||this.keyBuffer.add(t)},e.prototype.onKeyUp=function(e){var t=e.code;e.preventDefault(),this.ignoreKeys.includes(t)||this.keyBuffer.delete(t)},e.prototype.onMouseDown=function(){this.mousePressed=!0},e.prototype.onMouseUp=function(){this.mousePressed=!1},e.prototype.onClick=function(e){this.clickPos.set(e.x,e.y)},e.prototype.onContextMenu=function(e){this.contextClickPos.set(e.x,e.y)},e.prototype.onDoubleClick=function(e){this.dblClickPos.set(e.x,e.y)},e.prototype.onMouseMove=function(e){this.mousePos.set(e.x,e.y)},e.prototype.setupKeyboard=function(){window.addEventListener("keydown",this.boundHandlers.onKeyDown),window.addEventListener("keyup",this.boundHandlers.onKeyUp)},e.prototype.tearDownKeyboard=function(){window.removeEventListener("keydown",this.boundHandlers.onKeyDown),window.removeEventListener("keyup",this.boundHandlers.onKeyUp)},e.prototype.setupMouse=function(e){e.addEventListener("mousedown",this.boundHandlers.onMouseDown),e.addEventListener("mouseup",this.boundHandlers.onMouseUp),e.addEventListener("click",this.boundHandlers.onClick),e.addEventListener("contextmenu",this.boundHandlers.onContextMenu),e.addEventListener("dblclick",this.boundHandlers.onDoubleClick),e.addEventListener("mousemove",this.boundHandlers.onMouseMove)},e.prototype.tearDownMouse=function(e){e.removeEventListener("mousedown",this.boundHandlers.onMouseDown),e.removeEventListener("mouseup",this.boundHandlers.onMouseUp),e.removeEventListener("click",this.boundHandlers.onClick),e.removeEventListener("contextmenu",this.boundHandlers.onContextMenu),e.removeEventListener("dblclick",this.boundHandlers.onDoubleClick),e.removeEventListener("mousemove",this.boundHandlers.onMouseMove)},e}();t.InputManager=i},5179:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Keys=void 0,(r=t.Keys||(t.Keys={})).A="KeyA",r.B="KeyB",r.C="KeyC",r.D="KeyD",r.E="KeyE",r.F="KeyF",r.G="KeyG",r.H="KeyH",r.I="KeyI",r.J="KeyJ",r.K="KeyK",r.L="KeyL",r.M="KeyM",r.N="KeyN",r.O="KeyO",r.P="KeyP",r.Q="KeyQ",r.R="KeyR",r.S="KeyS",r.T="KeyT",r.U="KeyU",r.V="KeyV",r.W="KeyW",r.X="KeyX",r.Y="KeyY",r.Z="KeyZ",r.NUM_1="Digit1",r.NUM_2="Digit2",r.NUM_3="Digit3",r.NUM_4="Digit4",r.NUM_5="Digit5",r.NUM_6="Digit6",r.NUM_7="Digit7",r.NUM_8="Digit8",r.NUM_9="Digit9",r.NUM_0="Digit0",r.NUM_PAD_1="Numpad1",r.NUM_PAD_2="Numpad2",r.NUM_PAD_3="Numpad3",r.NUM_PAD_4="Numpad4",r.NUM_PAD_5="Numpad5",r.NUM_PAD_6="Numpad6",r.NUM_PAD_7="Numpad7",r.NUM_PAD_8="Numpad8",r.NUM_PAD_9="Numpad9",r.NUM_PAD_0="Numpad0",r.ARROW_LEFT="ArrowLeft",r.ARROW_RIGHT="ArrowRight",r.ARROW_UP="ArrowUp",r.ARROW_DOWN="ArrowDown",r.F_1="F1",r.F_2="F2",r.F_3="F3",r.F_4="F4",r.F_5="F5",r.F_6="F6",r.F_7="F7",r.F_8="F8",r.F_9="F9",r.F_10="F10",r.F_11="F11",r.F_12="F12",r.SPACE="Space",r.ENTER="Enter",r.SHIFT_LEFT="ShiftLeft",r.SHIFT_RIGHT="ShiftRight",r.CTRL_LEFT="ControlLeft",r.CTRL_RIGHT="ControlRight",r.ESC="Escape"},137:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Angle=void 0;var r=function(){function e(){}return e.toRadians=function(e){return e*(Math.PI/180)},e.toDegrees=function(e){return 180*e/Math.PI},e}();t.Angle=r},9076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;var n=r(9170),o=function(){function e(e,t,r,n){void 0===n&&(n=1),this.r=e,this.g=t,this.b=r,this.a=n,this.r=Math.max(Math.min(e,255),0),this.g=Math.max(Math.min(t,255),0),this.b=Math.max(Math.min(r,255),0),this.a=Math.max(Math.min(n,1),0)}return e.white=function(t){return new e(255,255,255,t)},e.black=function(t){return new e(0,0,0,t)},e.grey=function(t){return new e(128,128,128,t)},e.red=function(t){return new e(255,0,0,t)},e.green=function(t){return new e(0,255,0,t)},e.blue=function(t){return new e(0,0,255,t)},e.yellow=function(t){return new e(255,255,0,t)},e.magenta=function(t){return new e(255,0,255,t)},e.cyan=function(t){return new e(0,255,255,t)},e.random=function(t,r){return void 0===t&&(t=!1),void 0===r&&(r=1),new e(n.Random.between(0,255),n.Random.between(0,255),n.Random.between(0,255),t?n.Random.between(0,1):r)},e.randomList=function(t,r,n){void 0===r&&(r=!1),void 0===n&&(n=1);for(var o=[],i=0;i<t;i++)o.push(e.random(r,n));return o},e.rgba=function(t,r,n,o){return void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),new e(t,r,n,o)},e.hex=function(t){var r=0,n=0,o=0;if(t.startsWith("#"))switch(t.length){case 4:r=parseInt(t.substr(1,1).repeat(2),16),n=parseInt(t.substr(2,1).repeat(2),16),o=parseInt(t.substr(3,1).repeat(2),16);break;case 7:r=parseInt(t.substr(1,2),16),n=parseInt(t.substr(3,2),16),o=parseInt(t.substr(5,2),16)}else switch(t.length){case 3:r=parseInt(t.substr(0,1).repeat(2),16),n=parseInt(t.substr(1,1).repeat(2),16),o=parseInt(t.substr(2,1).repeat(2),16);break;case 6:r=parseInt(t.substr(0,2),16),n=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16)}return(isNaN(r)||isNaN(n)||isNaN(o))&&(r=n=o=0),new e(r,n,o)},e.toHex=function(e){var t=e.toString(16);return 1===t.length?"0".concat(t):t},Object.defineProperty(e.prototype,"hex",{get:function(){return"#".concat(e.toHex(this.r)).concat(e.toHex(this.g)).concat(e.toHex(this.b))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"float32Array",{get:function(){return Float32Array.from([this.rf,this.gf,this.bf,this.a])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rf",{get:function(){return this.r/255},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gf",{get:function(){return this.g/255},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bf",{get:function(){return this.b/255},enumerable:!1,configurable:!0}),e}();t.Color=o},6024:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Mat3=void 0;var r=function(){function e(t){void 0===t&&(t=e.IDENTITY.slice(0)),this.array=t}return e.add=function(t,r){var n=t.array,o=r.array;return new e([n[0]+o[0],n[1]+o[1],n[2]+o[2],n[3]+o[3],n[4]+o[4],n[5]+o[5],n[6]+o[6],n[7]+o[7],n[8]+o[8]])},e.sub=function(t,r){var n=t.array,o=r.array;return new e([n[0]-o[0],n[1]-o[1],n[2]-o[2],n[3]-o[3],n[4]-o[4],n[5]-o[5],n[6]-o[6],n[7]-o[7],n[8]-o[8]])},e.mult=function(t,r){var n=t.array,o=r.array,i=n[0],a=n[1],s=n[2],c=n[3],l=n[4],u=n[5],f=n[6],d=n[7],p=n[8],h=o[0],y=o[1],v=o[2],m=o[3],_=o[4],g=o[5],w=o[6],b=o[7],E=o[8];return new e([i*h+a*m+s*w,i*y+a*_+s*b,i*v+a*g+s*E,c*h+l*m+u*w,c*y+l*_+u*b,c*v+l*g+u*E,f*h+d*m+p*w,f*y+d*_+p*b,f*v+d*g+p*E])},e.multScalar=function(t,r){var n=t.array;return new e([n[0]*r,n[1]*r,n[2]*r,n[3]*r,n[4]*r,n[5]*r,n[6]*r,n[7]*r,n[8]*r])},e.invert=function(t){var r=t.determinant;return r?e.multScalar(e.adjoint(t),1/r):null},e.transpose=function(t){var r=t.array,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],c=r[5];return new e([n,a,r[6],o,s,r[7],i,c,r[8]])},e.adjoint=function(t){var r=t.array,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],c=r[5],l=r[6],u=r[7],f=r[8];return new e([s*f-c*u,-(o*f-i*u),o*c-i*s,-(a*f-c*l),n*f-i*l,-(n*c-i*a),a*u-s*l,-(n*u-o*l),n*s-o*a])},e.translate=function(t,r){var n=t.array,o=r.x,i=r.y,a=n[0],s=n[1],c=n[2],l=n[3],u=n[4],f=n[5];return new e([a,s,c,l,u,f,o*a+i*l+n[6],o*s+i*u+n[7],o*c+i*f+n[8]])},e.rotate=function(t,r){var n=t.array,o=Math.sin(r),i=Math.cos(r),a=n[0],s=n[1],c=n[2],l=n[3],u=n[4],f=n[5];return new e([i*a-o*l,i*s-o*u,i*c-o*f,i*l+o*a,i*u+o*s,i*f+o*c,n[6],n[7],n[8]])},e.fromRotation=function(t){var r=Math.sin(t),n=Math.cos(t);return new e([n,-r,0,r,n,0,0,0,1])},e.scale=function(t,r){var n=t.array,o=r.x,i=r.y;return new e([o*n[0],o*n[1],o*n[2],i*n[3],i*n[4],i*n[5],n[6],n[7],n[8]])},e.projection=function(t,r){return new e([2/t,0,0,0,2/r,0,0,0,1])},Object.defineProperty(e.prototype,"determinant",{get:function(){var e=this.array,t=e[0],r=e[1],n=e[2],o=e[0],i=e[1],a=(e[3],e[4]),s=e[5],c=e[3],l=(e[4],e[6]),u=e[7],f=e[8];return t*a*f+r*s*e[6]+n*c*e[7]-i*c*f-o*s*u-n*a*l},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"float32Array",{get:function(){return Float32Array.from(this.array)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"string",{get:function(){var e=this.array;return"Mat3\n".concat(e[0]," ").concat(e[1]," ").concat(e[2],"\n").concat(e[3]," ").concat(e[4]," ").concat(e[5],"\n").concat(e[6]," ").concat(e[7]," ").concat(e[8],"\n")},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.mutable.array=e.IDENTITY.slice(0)},e.prototype.clone=function(){return new e(this.array)},Object.defineProperty(e.prototype,"mutable",{get:function(){return this},enumerable:!1,configurable:!0}),e.IDENTITY=[1,0,0,0,1,0,0,0,1],e}();t.Mat3=r},9562:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Mat4=void 0;var n=r(137),o=r(1502),i=function(){function e(t){void 0===t&&(t=e.IDENTITY.slice(0)),this.array=t}return e.add=function(t,r){var n=t.array,o=r.array;return new e([n[0]+o[0],n[1]+o[1],n[2]+o[2],n[3]+o[3],n[4]+o[4],n[5]+o[5],n[6]+o[6],n[7]+o[7],n[8]+o[8],n[9]+o[9],n[10]+o[10],n[11]+o[11],n[12]+o[12],n[13]+o[13],n[14]+o[14],n[15]+o[15]])},e.sub=function(t,r){var n=t.array,o=r.array;return new e([n[0]-o[0],n[1]-o[1],n[2]-o[2],n[3]-o[3],n[4]-o[4],n[5]-o[5],n[6]-o[6],n[7]-o[7],n[8]-o[8],n[9]-o[9],n[10]-o[10],n[11]-o[11],n[12]-o[12],n[13]-o[13],n[14]-o[14],n[15]-o[15]])},e.mult=function(t,r){var n=t.array,o=r.array,i=n[0],a=n[1],s=n[2],c=n[3],l=n[4],u=n[5],f=n[6],d=n[7],p=n[8],h=n[9],y=n[10],v=n[11],m=n[12],_=n[13],g=n[14],w=n[15],b=o[0],E=o[1],T=o[2],x=o[3],O=o[4],P=o[5],C=o[6],S=o[7],A=o[8],M=o[9],R=o[10],j=o[11],I=o[12],N=o[13],V=o[14],F=o[15];return new e([i*b+a*O+s*A+c*I,i*E+a*P+s*M+c*N,i*T+a*C+s*R+c*V,i*x+a*S+s*j+c*F,l*b+u*O+f*A+d*I,l*E+u*P+f*M+d*N,l*T+u*C+f*R+d*V,l*x+u*S+f*j+d*F,p*b+h*O+y*A+v*I,p*E+h*P+y*M+v*N,p*T+h*C+y*R+v*V,p*x+h*S+y*j+v*F,m*b+_*O+g*A+w*I,m*E+_*P+g*M+w*N,m*T+_*C+g*j+w*V,m*x+_*S+g*j+w*F])},e.multScalar=function(t,r){var n=t.array;return new e([n[0]*r,n[1]*r,n[2]*r,n[3]*r,n[4]*r,n[5]*r,n[6]*r,n[7]*r,n[8]*r,n[9]*r,n[10]*r,n[11]*r,n[12]*r,n[13]*r,n[14]*r,n[15]*r])},e.invert=function(t){var r=t.determinant;return r?e.multScalar(e.adjoint(t),1/r):null},e.transpose=function(t){var r=t.array,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],c=r[5],l=r[6],u=r[7],f=r[8],d=r[9],p=r[10],h=r[11];return new e([n,s,f,r[12],o,c,d,r[13],i,l,p,r[14],a,u,h,r[15]])},e.adjoint=function(t){var r=t.array,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],c=r[5],l=r[6],u=r[7],f=r[8],d=r[9],p=r[10],h=r[11],y=r[12],v=r[13],m=r[14],_=r[15];return new e([c*(p*_-h*m)-l*(d*_-h*v)+u*(d*m-p*v),-(o*(p*_-h*m)-i*(d*_-h*v)+a*(d*m-p*v)),o*(l*_-u*m)-i*(c*_-u*v)+a*(c*m-l*v),-(o*(l*h-u*p)-i*(c*h-u*d)+a*(c*p-l*d)),-(s*(p*_-h*m)-l*(f*_-h*y)+u*(f*m-p*y)),n*(p*_-h*m)-i*(f*_-h*y)+a*(f*m-p*y),-(n*(l*_-u*m)-i*(s*_-u*y)+a*(s*m-l*y)),n*(l*h-u*p)-i*(s*h-u*f)+a*(s*p-l*f),s*(d*_-h*v)-c*(f*_-h*y)+u*(f*v-d*y),-(n*(d*_-h*v)-o*(f*_-h*y)+a*(f*v-d*y)),n*(c*_-u*v)-o*(s*_-u*y)+a*(s*v-c*y),-(n*(c*h-u*d)-o*(s*h-u*f)+a*(s*d-c*f)),-(s*(d*m-p*v)-c*(f*m-p*y)+l*(f*v-d*y)),n*(d*m-p*v)-o*(f*m-p*y)+i*(f*v-d*y),-(n*(c*m-l*v)-o*(s*m-l*y)+i*(s*v-c*y)),n*(c*p-l*d)-o*(s*p-l*f)+i*(s*d-c*f)])},e.translate=function(t,r){var n=t.array,o=r.x,i=r.y,a=r.z,s=n[0],c=n[1],l=n[2],u=n[3],f=n[4],d=n[5],p=n[6],h=n[7],y=n[8],v=n[9],m=n[10],_=n[11];return new e([s,c,l,u,f,d,p,h,y,v,m,_,o*s+i*f+a*y+n[12],o*c+i*d+a*v+n[13],o*l+i*p+a*m+n[14],o*u+i*h+a*_+n[15]])},e.rotateX=function(t,r){var n=t.array,o=Math.sin(r),i=Math.cos(r),a=n[0],s=n[1],c=n[2],l=n[3],u=n[4],f=n[5],d=n[6],p=n[7],h=n[8],y=n[9],v=n[10],m=n[11];return new e([a,s,c,l,i*u+o*h,i*f+o*y,i*d+o*v,i*p+o*m,i*h-o*u,i*y-o*f,i*v-o*d,i*m-o*p,n[12],n[13],n[14],n[15]])},e.rotateY=function(t,r){var n=t.array,o=Math.sin(r),i=Math.cos(r),a=n[0],s=n[1],c=n[2],l=n[3],u=n[4],f=n[5],d=n[6],p=n[7],h=n[8],y=n[9],v=n[10],m=n[11];return new e([i*a+o*h,i*s+o*y,i*c+o*v,i*l+o*m,u,f,d,p,i*h-o*a,i*y-o*s,i*v-o*c,i*m-o*l,n[12],n[13],n[14],n[15]])},e.rotateZ=function(t,r){var n=t.array,o=Math.sin(r),i=Math.cos(r),a=n[0],s=n[1],c=n[2],l=n[3],u=n[4],f=n[5],d=n[6],p=n[7];return new e([i*a-o*u,i*s-o*f,i*c-o*d,i*l-o*p,i*u+o*a,i*f+o*s,i*d+o*c,i*p+o*l,n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]])},e.fromAxisRotation=function(t,r){var n=o.Vec3.normalize(t),i=n.x,a=n.y,s=n.z,c=Math.sin(r),l=Math.cos(r),u=1-l;return new e([i*i*u+l,a*i*u+s*c,s*i*u-a*c,0,i*a*u-s*c,a*a*u+l,s*a*u+i*c,0,i*s*u+a*c,a*s*u-i*c,s*s*u+l,0,0,0,0,1])},e.scale=function(t,r){var n=t.array,o=r.x,i=r.y,a=r.z;return new e([o*n[0],o*n[1],o*n[2],o*n[3],i*n[4],i*n[5],i*n[6],i*n[7],a*n[8],a*n[9],a*n[10],a*n[11],n[12],n[13],n[14],n[15]])},e.perspective=function(t,r,o,i){var a=1/Math.tan(n.Angle.toRadians(t)/2);if(i){var s=1/(o-i);return new e([a/r,0,0,0,0,a,0,0,0,0,(i+o)*s,-1,0,0,2*i*o*s,0])}return new e([a/r,0,0,0,0,a,0,0,0,0,-1,-1,0,0,-2*o,0])},e.ortho=function(t,r,n,o,i,a){return new e([2/(r-t),0,0,0,0,2/(o-n),0,0,0,0,2/(i-a),0,(t+r)/(t-r),(n+o)/(n-o),(i+a)/(i-a),1])},e.lookAt=function(t,r,n){var i=o.Vec3.normalize(o.Vec3.sub(t,r)),a=o.Vec3.normalize(o.Vec3.cross(n,i)),s=o.Vec3.normalize(o.Vec3.cross(i,a));return new e([a.x,a.y,a.z,0,s.x,s.y,s.z,0,i.x,i.y,i.z,0,t.x,t.y,t.z,1])},Object.defineProperty(e.prototype,"determinant",{get:function(){var e=this.array,t=e[0],r=e[1],n=e[2],o=e[3],i=e[4],a=e[5],s=e[6],c=e[7],l=e[8],u=e[9],f=e[10],d=e[11],p=e[12],h=e[13],y=e[14],v=e[15];return t*(a*(f*v-d*y)-s*(u*v-d*h)+c*(u*y-f*h))-r*(i*(f*v-d*y)-s*(l*v-d*p)+c*(l*y-f*p))+n*(i*(u*v-d*h)-a*(l*v-d*p)+c*(l*h-u*p))-o*(i*(u*y-f*h)-a*(l*y-f*p)+s*(l*h-u*p))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forwardVector",{get:function(){return new o.Vec3(this.array[8],this.array[9],this.array[10])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightVector",{get:function(){return new o.Vec3(this.array[0],this.array[1],this.array[2])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upVector",{get:function(){return new o.Vec3(this.array[4],this.array[5],this.array[6])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"float32Array",{get:function(){return Float32Array.from(this.array)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"string",{get:function(){var e=this.array;return"Mat4\n".concat(e[0]," ").concat(e[1]," ").concat(e[2]," ").concat(e[3],"\n").concat(e[4]," ").concat(e[5]," ").concat(e[6]," ").concat(e[7],"\n").concat(e[8]," ").concat(e[9]," ").concat(e[10]," ").concat(e[11],"\n").concat(e[12]," ").concat(e[13]," ").concat(e[14]," ").concat(e[15])},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.mutable.array=e.IDENTITY.slice(0)},e.prototype.clone=function(){return new e(this.array)},Object.defineProperty(e.prototype,"mutable",{get:function(){return this},enumerable:!1,configurable:!0}),e.IDENTITY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e}();t.Mat4=i},9170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Random=void 0;var r=function(){function e(){}return e.between=function(e,t){return Math.random()*(t-e)+e},e}();t.Random=r},6042:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vec2=void 0;var n=r(1502),o=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.add=function(t,r){return new e(t.x+r.x,t.y+r.y)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y)},e.mult=function(t,r){return new e(t.x*r.x,t.y*r.y)},e.div=function(t,r){return new e(t.x/r.x,t.y/r.y)},e.scale=function(t,r){return new e(t.x*r,t.y*r)},e.negate=function(t){return new e(-t.x,-t.y)},e.invert=function(t){return new e(1/t.x,1/t.y)},e.normalize=function(t){var r=t.magnitude;return r>0?new e(t.x/r,t.y/r):new e},e.dot=function(e,t){return e.x*t.x+e.y*t.y},e.cross=function(e,t){return new n.Vec3(0,0,e.x*t.y-e.y*t.x)},e.distanceBetween=function(e,t){return Math.hypot(t.x-e.x,t.y-e.y)},e.angleBetween=function(t,r){var n=t.magnitude*r.magnitude,o=e.dot(t,r);return n>0?Math.acos(o/n):0},e.rotate=function(t,r){var n=Math.cos(r),o=Math.sin(r);return new e(t.x*n-t.y*o,t.x*o+t.y*n)},e.clamp=function(t,r,n){return new e(Math.min(Math.max(t.x,r.x),n.x),Math.min(Math.max(t.y,r.y),n.y))},e.transformByMat3=function(t,r){var n=t.x,o=t.y,i=r.array,a=i[0],s=i[1],c=i[3],l=i[4];return new e(a*n+c*o+i[6],s*n+l*o+i[7])},Object.defineProperty(e.prototype,"magnitude",{get:function(){return Math.hypot(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"array",{get:function(){return[this.x,this.y]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"float32Array",{get:function(){return Float32Array.from(this.array)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"string",{get:function(){return"Vec2( ".concat(this.x," , ").concat(this.y," )")},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.mutable.x=e,this.mutable.y=t},e.prototype.setX=function(e){void 0===e&&(e=0),this.mutable.x=e},e.prototype.setY=function(e){void 0===e&&(e=0),this.mutable.y=e},e.prototype.clone=function(){return new e(this.x,this.y)},Object.defineProperty(e.prototype,"mutable",{get:function(){return this},enumerable:!1,configurable:!0}),e}();t.Vec2=o},1502:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vec3=void 0;var r=function(){function e(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.x=e,this.y=t,this.z=r}return e.add=function(t,r){return new e(t.x+r.x,t.y+r.y,t.z+r.z)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y,t.z-r.z)},e.mult=function(t,r){return new e(t.x*r.x,t.y*r.y,t.z*r.z)},e.div=function(t,r){return new e(t.x/r.x,t.y/r.y,t.z/r.z)},e.scale=function(t,r){return new e(t.x*r,t.y*r,t.z*r)},e.negate=function(t){return new e(-t.x,-t.y,-t.z)},e.invert=function(t){return new e(1/t.x,1/t.y,1/t.z)},e.normalize=function(t){var r=t.magnitude;return r>0?new e(t.x/r,t.y/r,t.z/r):new e},e.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},e.cross=function(t,r){return new e(t.y*r.z-t.z*r.y,t.z*r.x-t.x*r.z,t.x*r.y-t.y*r.x)},e.distanceBetween=function(e,t){return Math.hypot(t.x-e.x,t.y-e.y,t.z-e.z)},e.angleBetween=function(t,r){var n=t.magnitude*r.magnitude,o=e.dot(t,r);return n>0?Math.acos(o/n):0},e.rotateX=function(t,r,n){var o=[t.x-r.x,t.y-r.y,t.z-r.z],i=[o[0],o[1]*Math.cos(n)-o[2]*Math.sin(n),o[1]*Math.sin(n)+o[2]*Math.cos(n)];return new e(i[0]+r.x,i[1]+r.y,i[2]+r.z)},e.rotateY=function(t,r,n){var o=[t.x-r.x,t.y-r.y,t.z-r.z],i=[o[2]*Math.sin(n)+o[0]*Math.cos(n),o[1],o[2]*Math.cos(n)-o[0]*Math.sin(n)];return new e(i[0]+r.x,i[1]+r.y,i[2]+r.z)},e.rotateZ=function(t,r,n){var o=[t.x-r.x,t.y-r.y,t.z-r.z],i=[o[0]*Math.cos(n)-o[1]*Math.sin(n),o[0]*Math.sin(n)+o[1]*Math.cos(n),o[2]];return new e(i[0]+r.x,i[1]+r.y,i[2]+r.z)},e.transformByMat4=function(t,r){var n=t.x,o=t.y,i=t.z,a=r.array,s=a[0],c=a[1],l=a[2],u=a[4],f=a[5],d=a[6],p=a[8],h=a[9],y=a[10];return new e(s*n+u*o+p*i+a[12],c*n+f*o+h*i+a[13],l*n+d*o+y*i+a[14])},Object.defineProperty(e.prototype,"magnitude",{get:function(){return Math.hypot(this.x,this.y,this.z)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"array",{get:function(){return[this.x,this.y,this.z]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"float32Array",{get:function(){return Float32Array.from(this.array)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"string",{get:function(){return"Vec3( ".concat(this.x," , ").concat(this.y," , ").concat(this.z," )")},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.mutable.x=e,this.mutable.y=t,this.mutable.z=r},e.prototype.setX=function(e){void 0===e&&(e=0),this.mutable.x=e},e.prototype.setY=function(e){void 0===e&&(e=0),this.mutable.y=e},e.prototype.setZ=function(e){void 0===e&&(e=0),this.mutable.z=e},e.prototype.clone=function(){return new e(this.x,this.y,this.z)},Object.defineProperty(e.prototype,"mutable",{get:function(){return this},enumerable:!1,configurable:!0}),e}();t.Vec3=r},2467:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vec4=void 0;var r=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=e,this.y=t,this.z=r,this.w=n}return e.add=function(t,r){return new e(t.x+r.x,t.y+r.y,t.z+r.z,t.w+r.w)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y,t.z-r.z,t.w-r.w)},e.mult=function(t,r){return new e(t.x*r.x,t.y*r.y,t.z*r.z,t.w*r.w)},e.div=function(t,r){return new e(t.x/r.x,t.y/r.y,t.z/r.z,t.w/r.w)},e.scale=function(t,r){return new e(t.x*r,t.y*r,t.z*r,t.w*r)},e.negate=function(t){return new e(-t.x,-t.y,-t.z,-t.w)},e.invert=function(t){return new e(1/t.x,1/t.y,1/t.z,1/t.w)},e.normalize=function(t){var r=t.magnitude;return r>0?new e(t.x/r,t.y/r,t.z/r,t.w/r):new e},e.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},e.distanceBetween=function(e,t){return Math.hypot(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.z)},Object.defineProperty(e.prototype,"magnitude",{get:function(){return Math.hypot(this.x,this.y,this.z,this.w)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"array",{get:function(){return[this.x,this.y,this.z,this.w]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"float32Array",{get:function(){return Float32Array.from(this.array)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"string",{get:function(){return"Vec4( ".concat(this.x," , ").concat(this.y," , ").concat(this.z," , ").concat(this.w," )")},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.mutable.x=e,this.mutable.y=t,this.mutable.z=r,this.mutable.w=n},e.prototype.setX=function(e){void 0===e&&(e=0),this.mutable.x=e},e.prototype.setY=function(e){void 0===e&&(e=0),this.mutable.y=e},e.prototype.setZ=function(e){void 0===e&&(e=0),this.mutable.z=e},e.prototype.setW=function(e){void 0===e&&(e=0),this.mutable.w=e},e.prototype.clone=function(){return new e(this.x,this.y,this.z,this.w)},Object.defineProperty(e.prototype,"mutable",{get:function(){return this},enumerable:!1,configurable:!0}),e}();t.Vec4=r},1125:function(e,t,r){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;var i=r(2189),a=r(8922),s=r(2371),c=r(3013),l=function(){function e(e,t){var r;this.shaderPrograms=new Map,this.activeShaderProgram=null,this.vbos=new Map,this.activeVBOName=null,this.textures=new Map,this.activeTexture=null,this.mode="2D",this.game=e;var n=null===(r=e.canvas)||void 0===r?void 0:r.getContext("webgl");if(!n)throw new i.AuraError({class:"Renderer",method:"construct",message:"Failed to retrieve WebGL Canvas context"});this.gl=n,this.backgroundColor=t.float32Array,this.init()}return Object.defineProperty(e.prototype,"activeTextureUnit",{get:function(){var e,t;return null!==(t=null===(e=this.activeTexture)||void 0===e?void 0:e.uniformUnit)&&void 0!==t?t:-1},enumerable:!1,configurable:!0}),e.prototype.clearScreen=function(){var e=this.gl.COLOR_BUFFER_BIT;"3D"===this.mode&&(e|=this.gl.DEPTH_BUFFER_BIT),this.gl.clear(e)},e.prototype.createVBO=function(e){var t=this.gl.createBuffer();if(!t)throw new i.AuraError({class:"Renderer",method:"createVBO",message:"Failed to create buffer with name '".concat(e,"'")});this.vbos.set(e,t)},e.prototype.deleteVBO=function(e){var t,r,o,i,a=this.gl,s=this.vbos.get(e);if(s){a.deleteBuffer(s),this.vbos.delete(e),this.activeVBOName="";try{for(var c=n(null!==(i=null===(o=this.activeShaderProgram)||void 0===o?void 0:o.attributeLocations)&&void 0!==i?i:[]),l=c.next();!l.done;l=c.next()){var u=l.value;a.disableVertexAttribArray(u.location)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}}},e.prototype.createShaderProgram=function(e){var t=this.gl,r=e.vertex,n=e.fragment,o=this.compileShader(e.name,t.VERTEX_SHADER,r.source),a=this.compileShader(e.name,t.FRAGMENT_SHADER,n.source),s=t.createProgram();if(!s)throw new i.AuraError({class:"Renderer",method:"createShaderProgram",message:"Failed to create Shader Program with name '".concat(e.name,"'")});if(t.attachShader(s,o),t.attachShader(s,a),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS)){var c=t.getProgramInfoLog(s);throw t.deleteProgram(s),t.deleteShader(a),t.deleteShader(o),new i.AuraError({class:"Renderer",method:"createShaderProgram",message:"Failed to link Shader Program with name '".concat(e.name,"' : [").concat(null!=c?c:"","]")})}this.initializeShaderProgram(s,e)},e.prototype.createTexture=function(e){var t=this.gl,r=t.TEXTURE0+this.textures.size;t.activeTexture(r);var n=t.createTexture();if(!n)throw new i.AuraError({class:"Renderer",method:"createTexture",message:"Failed to create texture with name '".concat(e.name,"' and src '").concat(e.src,"'")});t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([255,0,255,255])),t.bindTexture(t.TEXTURE_2D,null);var o=new Image;o.src=e.src,this.imageIsSameOrigin(e.src)||(o.crossOrigin=""),o.addEventListener("load",(function(){t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D)})),this.textures.set(e.name,{name:e.name,texture:n,unit:r,uniformUnit:r-t.TEXTURE0})},e.prototype.setRenderingMode=function(e){var t=this.gl;"3D"===e&&(t.enable(t.DEPTH_TEST),t.depthFunc(t.LESS),t.enable(t.CULL_FACE)),this.mode=e},e.prototype.render=function(e){var t,r,o,i,s,c,l,u,f,d,p=this.gl;e.shaderProgramName!==(null===(l=this.activeShaderProgram)||void 0===l?void 0:l.name)&&this.useShaderProgram(e.shaderProgramName),(e.vbo.name!==this.activeVBOName||e.vbo.changed)&&this.useVBO(e.vbo),e.textureAtlasName&&e.textureAtlasName!==(null===(u=this.activeTexture)||void 0===u?void 0:u.name)&&this.useTexture(e.textureAtlasName);var h=null===(f=this.activeShaderProgram)||void 0===f?void 0:f.staticUniformLocations,y=null===(d=this.activeShaderProgram)||void 0===d?void 0:d.entityUniformLocations;if(null==h?void 0:h.length)try{for(var v=n(h),m=v.next();!m.done;m=v.next()){var _=m.value;this.loadUniform(_.location,_.type,a.ShaderVariableResolver.resolveStaticUniform(_.name,this.game))}}catch(e){t={error:e}}finally{try{m&&!m.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}if(null==y?void 0:y.length){var g=0;try{for(var w=n(e.entities),b=w.next();!b.done;b=w.next()){var E=b.value;try{for(var T=(s=void 0,n(y)),x=T.next();!x.done;x=T.next()){var O=(_=x.value).location;O&&this.loadUniform(O,_.type,a.ShaderVariableResolver.resolveEntityUniform(_.name,E))}}catch(e){s={error:e}}finally{try{x&&!x.done&&(c=T.return)&&c.call(T)}finally{if(s)throw s.error}}p.drawArrays(e.vbo.glShape,g,e.vbo.vertexCount),g+=e.vbo.vertexCount}}catch(e){o={error:e}}finally{try{b&&!b.done&&(i=w.return)&&i.call(w)}finally{if(o)throw o.error}}}else p.drawArrays(e.vbo.glShape,0,e.vbo.vertexCount*e.entities.length)},e.prototype.destroy=function(){this.game=void 0},e.prototype.init=function(){var e=this.gl,t=o(this.backgroundColor,4),r=t[0],n=t[1],i=t[2],a=t[3];this.gl.clearColor(r,n,i,a),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.viewport(0,0,e.canvas.width,e.canvas.height)},e.prototype.compileShader=function(e,t,r){var n=this.gl,o=t===WebGLRenderingContext.VERTEX_SHADER?"Vertex Shader":"Fragment Shader",a=n.createShader(t);if(!a)throw new i.AuraError({class:"Renderer",method:"compileShader",message:"Failed to create ".concat(o," with name ").concat(e)});if(n.shaderSource(a,r),n.compileShader(a),!n.getShaderParameter(a,n.COMPILE_STATUS)){var s=n.getShaderInfoLog(a);throw n.deleteShader(a),new i.AuraError({class:"Renderer",method:"compileShader",message:"Failed to compile ".concat(o," with name ").concat(e," : [").concat(null!=s?s:"","]")})}return a},e.prototype.initializeShaderProgram=function(e,t){var r,o,a,s,l,u=this.gl;u.useProgram(e);var f=[];try{for(var d=n(t.vertex.attributes),p=d.next();!p.done;p=d.next()){var h=p.value;f.push({location:u.getAttribLocation(e,h.name),size:h.size})}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}var y=[],v=[],m=(null!==(l=t.vertex.uniforms)&&void 0!==l?l:[]).concat(t.fragment.uniforms);try{for(var _=n(m),g=_.next();!g.done;g=_.next()){var w=g.value,b=u.getUniformLocation(e,w.name),E=w.variation===c.UniformVariation.STATIC?y:v;if(!b)throw new i.AuraError({class:"Renderer",method:"initializeShaderProgram",message:"Failed to retrieve uniform location for uniform name '".concat(w.name,"' in shader program '").concat(t.name,"'")});E.push({name:w.name,location:b,type:w.type})}}catch(e){a={error:e}}finally{try{g&&!g.done&&(s=_.return)&&s.call(_)}finally{if(a)throw a.error}}this.shaderPrograms.set(t.name,{name:t.name,program:e,attributeLocations:f,staticUniformLocations:y,entityUniformLocations:v}),u.useProgram(null)},e.prototype.useShaderProgram=function(e){var t=this.gl,r=this.shaderPrograms.get(e);if(!r)throw new i.AuraError({class:"Renderer",method:"useShaderProgram",message:"Failed to switch to Shader Program with name '".concat(e,"'")});t.useProgram(r.program),this.activeShaderProgram=r},e.prototype.useVBO=function(e){var t,r,o,a,s=this.gl,c=this.vbos.get(e.name);if(!c)throw new i.AuraError({class:"Renderer",method:"useVBO",message:"Failed to switch to VBO with name '".concat(e.name,"'")});s.bindBuffer(s.ARRAY_BUFFER,c),e.changed&&s.bufferData(s.ARRAY_BUFFER,e.vertices,s.DYNAMIC_DRAW);var l=0;try{for(var u=n(null!==(a=null===(o=this.activeShaderProgram)||void 0===o?void 0:o.attributeLocations)&&void 0!==a?a:[]),f=u.next();!f.done;f=u.next()){var d=f.value;s.enableVertexAttribArray(d.location),s.vertexAttribPointer(d.location,d.size,s.FLOAT,!1,4*e.vertexSize,l),l+=4*d.size}}catch(e){t={error:e}}finally{try{f&&!f.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}this.activeVBOName=e.name},e.prototype.useTexture=function(e){var t=this.gl,r=this.textures.get(e);if(!r)throw new i.AuraError({class:"Renderer",method:"useTexture",message:"Failed to switch to Texture with name '".concat(e,"'")});t.activeTexture(r.unit),t.bindTexture(t.TEXTURE_2D,r.texture),this.activeTexture=r},e.prototype.loadUniform=function(e,t,r){var n=this.gl;switch(t){case s.UniformType.VEC2:n.uniform2fv(e,r);break;case s.UniformType.VEC3:n.uniform3fv(e,r);break;case s.UniformType.VEC4:n.uniform4fv(e,r);break;case s.UniformType.MAT3:n.uniformMatrix3fv(e,!1,r);break;case s.UniformType.MAT4:n.uniformMatrix4fv(e,!1,r);break;case s.UniformType.INTEGER:n.uniform1i(e,r);break;case s.UniformType.FLOAT:n.uniform1f(e,r)}},e.prototype.imageIsSameOrigin=function(e){return new URL(e,window.location.href).origin===window.location.origin},e}();t.Renderer=l},8423:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentShader=void 0;var r=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.config.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this.config.source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.config.uniforms},enumerable:!1,configurable:!0}),e}();t.FragmentShader=r},6628:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FRAGMENT_BASIC=void 0;var n=r(2371),o=r(3013),i=r(8423);t.FRAGMENT_BASIC=new i.FragmentShader({name:"fragment_basic",source:"\n        precision mediump float;\n\n        uniform vec4 u_Color;\n\n        void main() {\n            gl_FragColor = u_Color;\n        }\n    ",uniforms:[{name:"u_Color",type:n.UniformType.VEC4,variation:o.UniformVariation.ENTITY}]})},2476:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FRAGMENT_COLOR_PER_VERTEX=void 0;var n=r(8423);t.FRAGMENT_COLOR_PER_VERTEX=new n.FragmentShader({name:"fragment_color_per_vertex",source:"\n        precision mediump float;\n\n        varying vec4 v_Color;\n\n        void main() {\n            gl_FragColor = v_Color;\n        }\n    ",uniforms:[]})},6190:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FRAGMENT_TEXTURE=void 0;var n=r(2371),o=r(3013),i=r(8423);t.FRAGMENT_TEXTURE=new i.FragmentShader({name:"fragment_texture",source:"\n        precision mediump float;\n\n        uniform sampler2D u_Texture;\n\n        varying vec2 v_TexCoord;\n\n        void main() {\n            gl_FragColor = texture2D(u_Texture, v_TexCoord);\n        }\n    ",uniforms:[{name:"u_Texture",type:n.UniformType.INTEGER,variation:o.UniformVariation.STATIC}]})},4113:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FRAGMENT_TEXTURE_COLORED=void 0;var n=r(2371),o=r(3013),i=r(8423);t.FRAGMENT_TEXTURE_COLORED=new i.FragmentShader({name:"fragment_texture_colored",source:"\n        precision mediump float;\n\n        uniform sampler2D u_Texture;\n        uniform vec4 u_Color;\n\n        varying vec2 v_TexCoord;\n\n        void main() {\n            gl_FragColor = texture2D(u_Texture, v_TexCoord) * u_Color;\n        }\n    ",uniforms:[{name:"u_Texture",type:n.UniformType.INTEGER,variation:o.UniformVariation.STATIC},{name:"u_Color",type:n.UniformType.VEC4,variation:o.UniformVariation.ENTITY}]})},166:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PROGRAM_BASIC=void 0;var n=r(6628),o=r(3673),i=r(7691);t.PROGRAM_BASIC=new i.ShaderProgram({name:"program_basic",vertex:o.VERTEX_BASIC,fragment:n.FRAGMENT_BASIC})},6758:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PROGRAM_COLOR_PER_VERTEX=void 0;var n=r(2476),o=r(178),i=r(7691);t.PROGRAM_COLOR_PER_VERTEX=new i.ShaderProgram({name:"program_color_per_vertex",vertex:o.VERTEX_COLOR_PER_VERTEX,fragment:n.FRAGMENT_COLOR_PER_VERTEX})},377:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PROGRAM_TEXTURE=void 0;var n=r(6190),o=r(1644),i=r(7691);t.PROGRAM_TEXTURE=new i.ShaderProgram({name:"program_texture",vertex:o.VERTEX_TEXTURE,fragment:n.FRAGMENT_TEXTURE})},2818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PROGRAM_TEXTURE_COLORED=void 0;var n=r(4113),o=r(1644),i=r(7691);t.PROGRAM_TEXTURE_COLORED=new i.ShaderProgram({name:"program_texture_colored",vertex:o.VERTEX_TEXTURE,fragment:n.FRAGMENT_TEXTURE_COLORED})},7691:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderProgram=void 0;var r=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.config.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this.config.fragment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertex",{get:function(){return this.config.vertex},enumerable:!1,configurable:!0}),e}();t.ShaderProgram=r},8922:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderVariableResolver=void 0;var n=r(2189),o=function(){function e(){}return e.resolveAttribute=function(t,r){var o=e.ENTITY_ATTRIBUTE_MAPPINGS.get(t);if(!o)throw new n.AuraError({class:"ShaderVariableResolver",method:"resolveAttribute",message:"\n                    Failed to retrieve value for attribute name '".concat(t,"' : no resolution function exists for this variable\n                ")});return o(r)},e.resolveEntityUniform=function(t,r){var o=e.ENTITY_UNIFORM_MAPPINGS.get(t);if(!o)throw new n.AuraError({class:"ShaderVariableResolver",method:"resolveEntityUniform",message:"\n                    Failed to retrieve value for uniform name '".concat(t,"' : no resolution function exists for this variable\n                ")});return o(r)},e.resolveStaticUniform=function(t,r){var o=e.STATIC_UNIFORM_MAPPINGS.get(t);if(!o)throw new n.AuraError({class:"ShaderVariableResolver",method:"resolveStaticUniform",message:"\n                    Failed to retrieve value for uniform name '".concat(t,"' : no resolution function exists for this variable\n                ")});return o(r)},e.registerAttributeResolver=function(t,r){if(e.ENTITY_ATTRIBUTE_MAPPINGS.get(t))throw new n.AuraError({class:"ShaderVariableResolver",method:"registerAttributeResolver",message:"\n                    Failed to register resolution function for attribute name '".concat(t,"' : this variable is already registered.\n                    Override existing resolution functions with 'overrideAttributeResolver()'\n                ")});e.ENTITY_ATTRIBUTE_MAPPINGS.set(t,r)},e.registerEntityUniformResolver=function(t,r){if(e.ENTITY_UNIFORM_MAPPINGS.get(t))throw new n.AuraError({class:"ShaderVariableResolver",method:"registerEntityUniformResolver",message:"\n                    Failed to register entity resolution function for uniform name '".concat(t,"' : this variable is already registered.\n                    Override existing resolution functions with 'overrideEntityUniformResolver()'\n                ")});e.ENTITY_UNIFORM_MAPPINGS.set(t,r)},e.registerStaticUniformResolver=function(t,r){if(e.STATIC_UNIFORM_MAPPINGS.get(t))throw new n.AuraError({class:"ShaderVariableResolver",method:"registerStaticUniformResolver",message:"\n                    Failed to register static resolution function for uniform name '".concat(t,"' : this variable is already registered.\n                    Override existing resolution functions with 'overrideStaticUniformResolver()'\n                ")});e.STATIC_UNIFORM_MAPPINGS.set(t,r)},e.overrideAttributeResolver=function(t,r){if(!e.ENTITY_ATTRIBUTE_MAPPINGS.get(t))throw new n.AuraError({class:"ShaderVariableResolver",method:"overrideAttributeResolver",message:"\n                    Failed to override resolution function for attribute name '".concat(t,"' : this variable is not already registered.\n                    Add new resolution functions with 'registerAttributeResolver()'\n                ")});e.ENTITY_ATTRIBUTE_MAPPINGS.set(t,r)},e.overrideEntityUniformResolver=function(t,r){if(!e.ENTITY_UNIFORM_MAPPINGS.get(t))throw new n.AuraError({class:"ShaderVariableResolver",method:"overrideEntityUniformResolver",message:"\n                    Failed to override entity resolution function for uniform name '".concat(t,"' : this variable is not already\n                    registered.\n                    Add new resolution functions with 'registerEntityUniformResolver()'\n                ")});e.ENTITY_UNIFORM_MAPPINGS.set(t,r)},e.overrideStaticUniformResolver=function(t,r){if(!e.STATIC_UNIFORM_MAPPINGS.get(t))throw new n.AuraError({class:"ShaderVariableResolver",method:"overrideStaticUniformResolver",message:"\n                    Failed to override static resolution function for uniform name '".concat(t,"' : this variable is not already\n                    registered.\n                    Add new resolution functions with 'registerStaticUniformResolver()'\n                ")});e.STATIC_UNIFORM_MAPPINGS.set(t,r)},e.ENTITY_ATTRIBUTE_MAPPINGS=new Map([["a_Position",function(e){return e.getComponent("Model").vertices}],["a_Color",function(e){return e.getComponent("FlatColor").color.float32Array}],["a_VertexColor",function(e){return e.getComponent("MultiColor").nextColor().float32Array}],["a_TexCoord",function(e){return e.getComponent("Model").textureCoordinates}]]),e.ENTITY_UNIFORM_MAPPINGS=new Map([["u_Transform2D",function(e){return e.getComponent("Transform").compute().float32Array}],["u_Transform3D",function(e){return e.getComponent("Transform").compute().float32Array}],["u_Color",function(e){return e.getComponent("FlatColor").color.float32Array}]]),e.STATIC_UNIFORM_MAPPINGS=new Map([["u_Projection",function(e){return e.world.activeCamera.projection.float32Array}],["u_View",function(e){return e.world.activeCamera.getViewMatrix().float32Array}],["u_Texture",function(e){return e.renderer.activeTextureUnit}]]),e}();t.ShaderVariableResolver=o},2371:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.UniformType=void 0,(r=t.UniformType||(t.UniformType={})).VEC2="vec2",r.VEC3="vec3",r.VEC4="vec4",r.MAT3="mat3",r.MAT4="mat4",r.INTEGER="integer",r.FLOAT="float"},3013:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.UniformVariation=void 0,(r=t.UniformVariation||(t.UniformVariation={})).STATIC="static",r.ENTITY="entity"},3673:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERTEX_BASIC=void 0;var n=r(2371),o=r(3013),i=r(8235);t.VERTEX_BASIC=new i.VertexShader({name:"vertex_basic",source:"\n        uniform mat3 u_Transform2D;\n        uniform mat3 u_Projection;\n        uniform mat3 u_View;\n\n        attribute vec2 a_Position;\n\n        void main() {\n            gl_PointSize = 1.0;\n\n            gl_Position = vec4(u_Projection * u_View * u_Transform2D * vec3(a_Position, 1.0), 1.0);\n        }\n    ",attributes:[{name:"a_Position",size:2}],uniforms:[{name:"u_Transform2D",type:n.UniformType.MAT3,variation:o.UniformVariation.ENTITY},{name:"u_Projection",type:n.UniformType.MAT3,variation:o.UniformVariation.STATIC},{name:"u_View",type:n.UniformType.MAT3,variation:o.UniformVariation.STATIC}]})},178:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERTEX_COLOR_PER_VERTEX=void 0;var n=r(2371),o=r(3013),i=r(8235);t.VERTEX_COLOR_PER_VERTEX=new i.VertexShader({name:"vertex_color_per_vertex",source:"\n        precision mediump float;\n\n        uniform mat3 u_Transform2D;\n        uniform mat3 u_Projection;\n        uniform mat3 u_View;\n\n        attribute vec2 a_Position;\n        attribute vec4 a_VertexColor;\n\n        varying vec4 v_Color;\n\n        void main() {\n            v_Color = a_VertexColor;\n\n            gl_PointSize = 1.0;\n\n            gl_Position = vec4(u_Projection * u_View * u_Transform2D * vec3(a_Position, 1.0), 1.0);\n        }\n    ",attributes:[{name:"a_Position",size:2},{name:"a_VertexColor",size:4}],uniforms:[{name:"u_Transform2D",type:n.UniformType.MAT3,variation:o.UniformVariation.ENTITY},{name:"u_Projection",type:n.UniformType.MAT3,variation:o.UniformVariation.STATIC},{name:"u_View",type:n.UniformType.MAT3,variation:o.UniformVariation.STATIC}]})},1644:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERTEX_TEXTURE=void 0;var n=r(2371),o=r(3013),i=r(8235);t.VERTEX_TEXTURE=new i.VertexShader({name:"vertex_texture",source:"\n        precision mediump float;\n\n        uniform mat3 u_Transform2D;\n        uniform mat3 u_Projection;\n        uniform mat3 u_View;\n\n        attribute vec2 a_Position;\n        attribute vec2 a_TexCoord;\n\n        varying vec2 v_TexCoord;\n\n        void main() {\n            v_TexCoord = a_TexCoord;\n\n            gl_PointSize = 1.0;\n\n            gl_Position = vec4(u_Projection * u_View * u_Transform2D * vec3(a_Position, 1.0), 1.0);\n        }\n    ",attributes:[{name:"a_Position",size:2},{name:"a_TexCoord",size:2}],uniforms:[{name:"u_Transform2D",type:n.UniformType.MAT3,variation:o.UniformVariation.ENTITY},{name:"u_Projection",type:n.UniformType.MAT3,variation:o.UniformVariation.STATIC},{name:"u_View",type:n.UniformType.MAT3,variation:o.UniformVariation.STATIC}]})},8235:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VertexShader=void 0;var r=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.config.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this.config.source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributes",{get:function(){return this.config.attributes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.config.uniforms},enumerable:!1,configurable:!0}),e}();t.VertexShader=r},7389:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.State=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(r(8092).StateBase);t.State=i},8092:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StateBase=void 0;var r=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.config.name},enumerable:!1,configurable:!0}),e.prototype.init=function(e){var t,r;null===(r=(t=this.config).init)||void 0===r||r.call(t,e)},e.prototype.tick=function(e,t){this.config.tick(e,t)},e.prototype.end=function(e){var t,r;null===(r=(t=this.config).end)||void 0===r||r.call(t,e)},e}();t.StateBase=r},4676:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Collision=void 0;var i=function(e){function t(){var t=e.call(this,"Collision")||this;return t.collisions=[],t}return o(t,e),t.prototype.tick=function(e){for(var t=e.world.filterEntitiesByComponentNames("Transform","BoxCollider"),r=0;r<t.length;r++)for(var n=r+1;n<t.length;n++){var o="".concat(t[r].id,"-").concat(t[n].id);this.collides(t[r],t[n])?this.collisions.includes(o)?(t[r].onCollisionContinue(e,t[n]),t[n].onCollisionContinue(e,t[r])):(t[r].onCollisionStart(e,t[n]),t[n].onCollisionStart(e,t[r]),this.collisions.push(o)):this.collisions.includes(o)&&(t[r].onCollisionEnd(e,t[n]),t[n].onCollisionEnd(e,t[r]),this.collisions.splice(this.collisions.indexOf(o),1))}},t.prototype.collides=function(e,t){var r,n,o=e.getComponent("Transform"),i=null!==(r=e.getComponent("BoxCollider").dimensions)&&void 0!==r?r:o.scale,a=o.position.x-i.x/2,s=o.position.x+i.x/2,c=o.position.y+i.y/2,l=o.position.y-i.y/2,u=t.getComponent("Transform"),f=null!==(n=t.getComponent("BoxCollider").dimensions)&&void 0!==n?n:u.scale,d=u.position.x-f.x/2,p=u.position.x+f.x/2,h=u.position.y+f.y/2,y=u.position.y-f.y/2;return a<p&&s>d&&c>y&&l<h},t}(r(7669).System);t.Collision=i},6864:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Physics=void 0;var a=r(6042),s=function(e){function t(){return e.call(this,"Physics")||this}return o(t,e),t.prototype.tick=function(e,t){var r,n,o=e.world.filterEntitiesByComponentName("Transform");try{for(var s=i(o),c=s.next();!c.done;c=s.next()){var l=c.value.getComponent("Transform");l.move(a.Vec2.scale(l.velocity,t/1e3))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}},t}(r(7669).System);t.Physics=s},7669:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.System=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(r(5761).SystemBase);t.System=i},5761:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SystemBase=void 0;t.SystemBase=function(e){this.name=e}},8097:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Char=void 0;var i=r(6994),a=r(983),s=r(9468),c=r(604),l=r(3111),u=r(2182),f=r(4240),d=r(2818),p=function(e){function t(t,r,n,o){return e.call(this,{tag:"char",components:[new i.Transform(t,r),new c.Shader(d.PROGRAM_TEXTURE_COLORED),new s.Model(f.SQUARE),new l.Texture(n.x,n.y),new a.FlatColor(o)]})||this}return o(t,e),t}(u.Entity);t.Char=p},7454:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0;var c=r(6042),l=r(8442),u=r(8097),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.addString=function(e,t,r,n){var o,l,f=[],d=0;try{for(var p=i(e),h=p.next();!h.done;h=p.next()){var y=h.value;f.push(new u.Char(c.Vec2.add(t,new c.Vec2(d*r.x,0)),r,new c.Vec2(this.config.charset.indexOf(y.toUpperCase()),0),n)),d++}}catch(e){o={error:e}}finally{try{h&&!h.done&&(l=p.return)&&l.call(p)}finally{if(o)throw o.error}}this.addEntities.apply(this,s([],a(f),!1))},t}(l.TextManager);t.Text=f},8442:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.TextManager=void 0;var a=function(e){function t(t){return e.call(this,i({name:"font"},t))||this}return o(t,e),t}(r(1241).EntityManager);t.TextManager=a},1422:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;var r=function(){function e(e,t,r,n,o,i){this.name=e,this.src=t,this.width=r,this.height=n,this.columns=o,this.rows=i}return e.prototype.resolveTextureCoordinates=function(e,t,r,n,o){var i=(t+e[0])*(n/this.columns)-(n-1)/this.columns*t,a=1-((r+e[1])*(o/this.rows)-(o-1)/this.rows*r),s=(i*this.width+.5-1)/this.width;s<0&&(s=(i*this.width+.5)/this.width);var c=(a*this.height+.5-1)/this.height;return c<0&&(c=(a*this.height+.5)/this.height),Float32Array.from([s,c])},e}();t.TextureAtlas=r},2038:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Panel=void 0;var i=r(6994),a=r(983),s=r(9468),c=r(604),l=r(2182),u=r(4240),f=r(166),d=function(e){function t(t,r,n){return e.call(this,{tag:"panel",components:[new i.Transform(t,r),new c.Shader(f.PROGRAM_BASIC),new s.Model(u.SQUARE),new a.FlatColor(n)]})||this}return o(t,e),t}(l.Entity);t.Panel=d},2280:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.UI=void 0;var i=r(7523),a=r(2038),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.addPanel=function(e,t,r){this.addEntity(new a.Panel(e,t,r))},t}(i.UIManager);t.UI=s},7523:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.UIManager=void 0;var a=function(e){function t(t){return e.call(this,i({name:"ui"},t))||this}return o(t,e),t}(r(1241).EntityManager);t.UIManager=a},7057:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.World=void 0;var i=r(4499),a=r(2189),s=function(e){function t(t){var r=e.call(this,t)||this;r.cameras=new Map;var n=new i.Camera({name:"default",offset:t.camera.offset,projection:t.camera.projection});return r.addCamera(n),r.activeCamera=n,r}return o(t,e),Object.defineProperty(t.prototype,"dimensions",{get:function(){return this.config.dimensions},enumerable:!1,configurable:!0}),t.prototype.addCamera=function(e){this.cameras.set(e.name,e)},t.prototype.getCamera=function(e){var t=this.cameras.get(e);if(!t)throw new a.AuraError({class:"World",method:"getCamera",message:"Failed to retrieve 2D Camera with name ".concat(e)});return t},t}(r(4842).WorldManager);t.World=s},4842:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.WorldManager=void 0;var a=r(2189),s=function(e){function t(t){return e.call(this,i({name:"world"},t))||this}return o(t,e),t.prototype.removeCamera=function(e){this.cameras.delete(e)},t.prototype.switchToCamera=function(e){var t=this.cameras.get(e);if(!t)throw new a.AuraError({class:"World",method:"switchToCamera",message:"Failed to switch to Camera with name ".concat(e)});this.activeCamera=t},t}(r(1241).EntityManager);t.WorldManager=s},1207:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Effect=void 0;var i=r(9323),a=r(3081),s=function(e){function t(){for(var t=e.call(this,"Effect")||this,r=Math.random()<=.7?a.powerups:a.powerdowns,n=100*Math.random(),o=0,i=0,s=r;i<s.length;i++){var c=s[i];if(n<=o+c.chance){t.power=c;break}o+=c.chance}return t.power=r[0],t}return o(t,e),t}(i.Component);t.Effect=s},3663:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Explosive=void 0;var i=function(e){function t(){return e.call(this,"Explosive")||this}return o(t,e),t}(r(9323).Component);t.Explosive=i},8786:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Invincible=void 0;var i=function(e){function t(){return e.call(this,"Invincible")||this}return o(t,e),t}(r(9323).Component);t.Invincible=i},3883:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Reverse=void 0;var i=function(e){function t(){return e.call(this,"Reverse")||this}return o(t,e),t}(r(9323).Component);t.Reverse=i},1743:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};t.__esModule=!0,t.Ball=void 0;var a=r(9323),s=r(4693),c=r(7097),l=r(7123),u=r(8525),f=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this,{tag:"ball".concat(t?"-multi":""),components:[new a.Transform(new a.Vec2,new a.Vec2(25,25)),new a.Model(a.Geometries.CIRCLE),new a.Shader(a.ShaderPrograms.BASIC),new a.FlatColor(t?a.Color.yellow():a.Color.white()),new a.BoxCollider(new a.Vec2(20,20))]})||this;return r.multi=t,r.attached=!0,r.didCollide=!1,r.defaultVelocity=new a.Vec2(300,300),r.maxVelocity=new a.Vec2(500,500),r.previousPos=new a.Vec2,r}return o(t,e),t.prototype.tick=function(e){var t,r=this.getComponent("Transform");if(this.attached){var n=e.world.filterEntitiesByTag("paddle")[0];if(n){var o=n.getComponent("Transform"),a=o.position.y+.5*(o.scale.y+r.scale.y);r.position.set(o.position.x,a)}this.multi&&this.toggleAttached()}else r.position.y+.75*r.scale.y<=-e.world.dimensions.y/2&&(s.PowerHandler.deactivatePower(e),this.multi?e.world.removeEntity(this):(this.toggleAttached(),e.setData("balls",e.getData("balls")-1),e.setData("multiplier",1),(t=e.world).removeEntities.apply(t,i(i([],e.world.filterEntitiesByTag("powerup"),!1),e.world.filterEntitiesByTag("coin"),!1))));this.didCollide=!1,this.previousPos.set(r.position.x,r.position.y)},t.prototype.onCollisionStart=function(e,t){var r=this.getComponent("Transform"),n=t.getComponent("Transform"),o=1,i=1,f=0;if("wall-vert"===t.tag)o=-1;else if("wall-hor"===t.tag)i=-1;else if("paddle"===t.tag){this.multi||e.setData("multiplier",1);var d=a.Vec2.normalize(a.Vec2.sub(r.position,n.position));o=Math.abs(2*d.x),i=-1,(r.position.x<=n.position.x-n.scale.x/8&&r.velocity.x>0||r.position.x>=n.position.x+n.scale.x/8&&r.velocity.x<0)&&(o=-o),f=10}else if("brick"===t.tag){if(this.didCollide||this.hasComponent("Invincible"))return;if(this.didCollide=!0,d=a.Vec2.sub(this.previousPos,n.position),Math.abs(d.x)/n.scale.x*100>=Math.abs(d.y)/n.scale.y*100?o=-1:i=-1,f=10,this.hasComponent("Explosive")&&e.world.addEntity(new l.Explosion(r.position,r.scale)),!t.hasComponent("Invincible")){var p=Math.random();p<=.075?e.world.addEntity(new c.Coin(n.position)):p<=.15&&!e.world.filterEntitiesByTag("powerup").length&&!s.PowerHandler.isPowerActive()&&e.world.addEntity(new u.Power(n.position))}}this.changeVelocity(f),this.applyVelocityMultipliers(o,i)},t.prototype.isAttached=function(){return this.attached},t.prototype.toggleAttached=function(){this.attached=!this.attached;var e=this.getComponent("Transform");this.attached?e.velocity.set():e.velocity.set(this.defaultVelocity.x*(Math.random()<=.5?-1:1),this.defaultVelocity.y)},t.prototype.changeVelocity=function(e){var t=this.getComponent("Transform"),r=this.getClampedVelocity(new a.Vec2(t.velocity.x>0?t.velocity.x+e:t.velocity.x-e,t.velocity.y>0?t.velocity.y+e:t.velocity.y-e));t.velocity.set(r.x,r.y)},t.prototype.applyVelocityMultipliers=function(e,t){var r=this.getComponent("Transform"),n=this.getClampedVelocity(a.Vec2.mult(r.velocity,new a.Vec2(e,t)));r.velocity.set(n.x,n.y)},t.prototype.getClampedVelocity=function(e){var t=e.clone();return Math.abs(t.x)>=Math.abs(this.maxVelocity.x)&&t.setX(t.x>0?this.maxVelocity.x:-this.maxVelocity.x),Math.abs(t.y)>=Math.abs(this.maxVelocity.y)&&t.setY(e.y>0?this.maxVelocity.y:-this.maxVelocity.y),t},t}(a.Entity);t.Ball=f},2496:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Brick=void 0;var i=r(9323),a=function(e){function t(t,r,n){return e.call(this,{tag:"brick",components:[new i.Transform(t,r),new i.Model(i.Geometries.SQUARE),new i.Shader(i.ShaderPrograms.BASIC),new i.FlatColor(n),new i.BoxCollider]})||this}return o(t,e),t.prototype.onCollisionStart=function(e,t){if(!this.hasComponent("Invincible")&&(t.tag.includes("ball")||"explosion"===t.tag)){e.world.removeEntity(this);var r=e.getData("multiplier");e.setData("points",e.getData("points")+r),e.setData("multiplier",r+1)}},t}(i.Entity);t.Brick=a},7097:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Coin=void 0;var i=r(9323),a=function(e){function t(t){var r=e.call(this,{tag:"coin",components:[new i.Transform(t,new i.Vec2(25,25)),new i.Model(i.Geometries.OCTAGON),new i.Shader(i.ShaderPrograms.BASIC),new i.FlatColor(i.Color.yellow()),new i.BoxCollider(new i.Vec2(20,20))]})||this;return r.speed=150+Math.round(i.Random.between(50,150)),r}return o(t,e),t.prototype.tick=function(e,t){var r=this.getComponent("Transform");r.translate(new i.Vec2(0,-this.speed*t/1e3)),r.position.y<=-e.world.dimensions.y/2-r.scale.y/2&&e.world.removeEntity(this)},t.prototype.onCollisionStart=function(e,t){"paddle"===t.tag&&(e.world.removeEntity(this),e.setData("points",e.getData("points")+10*e.getData("multiplier")))},t}(i.Entity);t.Coin=a},7123:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Explosion=void 0;var i=r(9323),a=function(e){function t(t,r){return e.call(this,{tag:"explosion",components:[new i.Transform(t,i.Vec2.scale(r,7.5)),new i.BoxCollider]})||this}return o(t,e),t.prototype.onCollisionStart=function(e){e.world.removeEntity(this)},t}(i.Entity);t.Explosion=a},9740:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Paddle=void 0;var i=r(9323),a=function(e){function t(t,r){return e.call(this,{tag:"paddle",components:[new i.Transform(new i.Vec2(0,2*r-t),new i.Vec2(110,25)),new i.Model(i.Geometries.SQUARE),new i.Shader(i.ShaderPrograms.BASIC),new i.FlatColor(i.Color.rgba(50,255,75)),new i.BoxCollider]})||this}return o(t,e),t.prototype.tick=function(e){var t=this.getComponent("Transform"),r=e.world.dimensions.x,n=e.input.mousePos.x,o=t.scale.x,i=e.getData("wallSize"),a=this.hasComponent("Reverse")?r/2-n:n-r/2;this.getComponent("Transform").position.setX(Math.min(Math.max(.5*(o-r)+i,a),.5*(r-o)-i))},t}(i.Entity);t.Paddle=a},8525:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Power=void 0;var i=r(9323),a=r(1207),s=r(4693),c=function(e){function t(t){return e.call(this,{tag:"power",components:[new i.Transform(t,new i.Vec2(30,30),0,new i.Vec2(0,0)),new i.Model(i.Geometries.HEXAGON),new i.Shader(i.ShaderPrograms.BASIC),new i.FlatColor(i.Color.green()),new i.BoxCollider,new a.Effect]})||this}return o(t,e),t.prototype.tick=function(e,t){var r=this.getComponent("Transform");r.rotate(i.Angle.toRadians(1)),r.translate(new i.Vec2(0,-100*t/1e3)),r.position.y<=-e.world.dimensions.y/2-r.scale.y/2&&e.world.removeEntity(this)},t.prototype.onCollisionStart=function(e,t){"paddle"===t.tag&&(e.world.removeEntity(this),s.PowerHandler.activatePower(this.getComponent("Effect").power,e))},t}(i.Entity);t.Power=c},6873:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.Wall=void 0;var i=r(9323),a=function(e){function t(t,r,n){return e.call(this,{tag:"wall-".concat(n?"vert":"hor"),components:[new i.Transform(t,r),new i.Model(i.Geometries.SQUARE),new i.Shader(i.ShaderPrograms.BASIC),new i.FlatColor(i.Color.rgba(50,255,75)),new i.BoxCollider]})||this}return o(t,e),t}(i.Entity);t.Wall=a},3610:(e,t,r)=>{t.__esModule=!0,t.flipped=void 0;var n=r(9323),o=r(3883);t.flipped={name:"Flipped!",timeout:3500,chance:10,activate:function(e){var t;e.world.activeCamera.rotate(n.Angle.toRadians(180)),null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.addComponent(new o.Reverse)},deactivate:function(e){var t;e.world.activeCamera.rotate(n.Angle.toRadians(180)),null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.removeComponent("Reverse")}}},6175:(e,t,r)=>{t.__esModule=!0,t.invincibleBricks=void 0;var n=r(8786);t.invincibleBricks={name:"Invincible Bricks",timeout:7500,chance:30,activate:function(e){e.world.filterEntitiesByTag("brick").forEach((function(e){return e.addComponent(new n.Invincible)}))},deactivate:function(e){e.world.filterEntitiesByTag("brick").forEach((function(e){return e.removeComponent("Invincible")}))}}},7092:(e,t,r)=>{t.__esModule=!0,t.reversePaddle=void 0;var n=r(3883);t.reversePaddle={name:"Reverse Paddle",timeout:5e3,chance:10,activate:function(e){var t;null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.addComponent(new n.Reverse)},deactivate:function(e){var t;null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.removeComponent("Reverse")}}},7217:(e,t,r)=>{t.__esModule=!0,t.smallPaddle=void 0;var n=r(9323);t.smallPaddle={name:"Small Paddle",timeout:1e4,chance:50,activate:function(e){var t;null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.getComponent("Transform").scaleBy(new n.Vec2(.5,1))},deactivate:function(e){var t;null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.getComponent("Transform").scaleBy(new n.Vec2(2,1))}}},3081:(e,t,r)=>{t.__esModule=!0,t.powerdowns=t.powerups=void 0;var n=r(3610),o=r(6175),i=r(7092),a=r(7217),s=r(9169),c=r(9082),l=r(2825),u=r(9790),f=r(1647);t.powerups=[s.bigPaddle,c.explosiveBall,l.extraBall,u.multiBall,f.powerBall].sort((function(e,t){return e.chance-t.chance})),t.powerdowns=[n.flipped,o.invincibleBricks,i.reversePaddle,a.smallPaddle].sort((function(e,t){return e.chance-t.chance}))},9169:(e,t,r)=>{t.__esModule=!0,t.bigPaddle=void 0;var n=r(9323);t.bigPaddle={name:"Big Paddle",timeout:1e4,chance:30,activate:function(e){var t;null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.getComponent("Transform").scaleBy(new n.Vec2(2,1))},deactivate:function(e){var t;null===(t=e.world.filterEntitiesByTag("paddle")[0])||void 0===t||t.getComponent("Transform").scaleBy(new n.Vec2(.5,1))}}},9082:(e,t,r)=>{t.__esModule=!0,t.explosiveBall=void 0;var n=r(3663);t.explosiveBall={name:"Explosive Ball",timeout:2500,chance:20,activate:function(e){var t;null===(t=e.world.filterEntitiesByTag("ball")[0])||void 0===t||t.addComponent(new n.Explosive)},deactivate:function(e){var t;null===(t=e.world.filterEntitiesByTag("ball")[0])||void 0===t||t.removeComponent("Explosive")}}},2825:(e,t)=>{t.__esModule=!0,t.extraBall=void 0,t.extraBall={name:"Extra Ball",timeout:2e3,chance:20,activate:function(e){e.setData("balls",e.getData("balls")+1)},deactivate:function(){}}},9790:(e,t,r)=>{t.__esModule=!0,t.multiBall=void 0;var n=r(1743);t.multiBall={name:"Multiball",timeout:1e4,chance:15,activate:function(e){e.world.addEntities(new n.Ball(!0))},deactivate:function(e){var t;(t=e.world).removeEntities.apply(t,e.world.filterEntitiesByTag("ball-multi"))}}},1647:(e,t,r)=>{t.__esModule=!0,t.powerBall=void 0;var n=r(8786);t.powerBall={name:"Power Ball",timeout:5e3,chance:15,activate:function(e){var t;null===(t=e.world.filterEntitiesByTag("ball")[0])||void 0===t||t.addComponent(new n.Invincible)},deactivate:function(e){var t;null===(t=e.world.filterEntitiesByTag("ball")[0])||void 0===t||t.removeComponent("Invincible")}}},8265:function(e,t,r){var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};t.__esModule=!0,t.GAME_STATE=void 0;var o,i,a=r(9323),s=r(4693);t.GAME_STATE=new a.State({name:"game",init:function(e){e.addSystems(new a.Physics,new a.Collision,new s.PowerHandler),o=!0,i=0},end:function(e){var t;e.text.clearEntities(),(t=e.world).removeEntities.apply(t,n(n(n(n(n([],e.world.filterEntitiesByTag("ball"),!1),e.world.filterEntitiesByTag("ball-multi"),!1),e.world.filterEntitiesByTag("coin"),!1),e.world.filterEntitiesByTag("power"),!1),e.world.filterEntitiesByTag("explosion"),!1)),s.PowerHandler.deactivatePower(e),e.removeSystems("Physics","Collision","PowerHandler")},tick:function(e,t){if(e.text.clearEntities(),o){var r="level ".concat(e.getData("level"));e.text.addString(r,new a.Vec2(r.length/2*-50,-e.world.dimensions.y/4+30),new a.Vec2(50,50),a.Color.white()),(i+=t)>=500&&(o=!1,i=0)}if(s.PowerHandler.isPowerActive()){var n=s.PowerHandler.activePowerName();e.text.addString(n,new a.Vec2(-n.length/2*50,-e.world.dimensions.y/4+30),new a.Vec2(50,50),a.Color.white())}var c=e.getData("balls");if(c<=0)e.switchToState("gameOver");else{if(e.world.filterEntitiesByTag("brick").length<=0)return e.setData("level",e.getData("level")+1),void e.switchToState("gameSetup");var l=e.world.filterEntitiesByTag("ball")[0],u=e.world.filterEntitiesByTag("paddle")[0];l&&u&&l.isAttached()&&(e.text.addString("click",new a.Vec2(-125,-e.world.dimensions.y/4+30),new a.Vec2(50,50),a.Color.white()),e.input.isMouseDown()&&l.toggleAttached()),e.text.addString("balls: ".concat(c),new a.Vec2(-e.world.dimensions.x/2+50,e.world.dimensions.y/2-50),new a.Vec2(20,20),a.Color.white()),e.text.addString("points: ".concat(e.getData("points")),new a.Vec2(-e.world.dimensions.x/2+50,e.world.dimensions.y/2-80),new a.Vec2(20,20),a.Color.white())}}})},1282:(e,t,r)=>{t.__esModule=!0,t.GAME_OVER_STATE=void 0;var n=r(9323);t.GAME_OVER_STATE=new n.State({name:"gameOver",init:function(e){e.setData("level",1)},end:function(e){e.text.clearEntities(),e.world.clearEntities()},tick:function(e){e.text.clearEntities();var t=e.world.filterEntitiesByTag("brick");if(t.length)e.world.removeEntity(t[t.length-1]);else{if(e.input.isMouseDown())return void e.switchToState("gameSetup");var r="game over",o="points: ".concat(e.getData("points")),i="click";e.text.addString(r,new n.Vec2(-r.length/2*50,e.world.dimensions.y/4),new n.Vec2(50,50),n.Color.white()),e.text.addString(o,new n.Vec2(-o.length/2*50,0),new n.Vec2(50,50),n.Color.white()),e.text.addString(i,new n.Vec2(-i.length/2*50,-e.world.dimensions.y/4+30),new n.Vec2(50,50),n.Color.white())}}})},4978:(e,t,r)=>{t.__esModule=!0,t.GAME_SETUP_STATE=void 0;var n=r(9323),o=r(1743),i=r(2496),a=r(9740),s=r(6873),c=[];t.GAME_SETUP_STATE=new n.State({name:"gameSetup",init:function(e){for(var t=e.world.dimensions.x/2,r=e.world.dimensions.y/2,l=e.getData("wallSize"),u=e.getData("brickRows"),f=e.getData("brickColumns"),d=e.getData("brickPadding"),p=e.getData("brickMargin"),h=(2*t-2*l-2*p-d*(f-1))/f,y=(r-l-p-d*(u-1))/u,v=-t+l+p+h/2,m=t-l-p,_=r-l-p,g=y/2;g<=_;g+=y+d)for(var w=n.Color.random(),b=v;b<=m;b+=h+d)c.push(new i.Brick(new n.Vec2(b,g),new n.Vec2(h,y),w));c.reverse(),e.world.addEntity(new o.Ball),1===e.getData("level")&&(e.setData("balls",2),e.setData("points",0),e.setData("multiplier",1),e.world.addEntities(new a.Paddle(r,l),new s.Wall(new n.Vec2(l/2-t,0),new n.Vec2(l,e.world.dimensions.y),!0),new s.Wall(new n.Vec2(t-l/2,0),new n.Vec2(l,e.world.dimensions.y),!0),new s.Wall(new n.Vec2(0,r-l/2),new n.Vec2(e.world.dimensions.x,l),!1))),e.text.addString("ready",new n.Vec2(-125,-e.world.dimensions.y/4+30),new n.Vec2(50,50),n.Color.white())},end:function(e){e.text.clearEntities()},tick:function(e){var t=c.pop();t?e.world.addEntity(t):(e.world.filterEntitiesByTag("ball")[0].toggleAttached(),e.switchToState("game"))}})},2131:(e,t,r)=>{t.__esModule=!0,t.MENU_STATE=void 0;var n=r(9323),o=r(1207);t.MENU_STATE=new n.State({name:"menu",init:function(e){var t="breakout",r="click";e.text.addString(t,new n.Vec2(-t.length/2*50,e.world.dimensions.y/4),new n.Vec2(50,50),n.Color.white()),e.text.addString(r,new n.Vec2(-r.length/2*50,-e.world.dimensions.y/4+30),new n.Vec2(50,50),n.Color.white());for(var i=[],a=0;a<=999;a++)i.push((new o.Effect).power.name);for(var s={},c=0,l=i;c<l.length;c++){var u=l[c];void 0===s[u]?s[u]=1:s[u]++}console.log(s)},end:function(e){e.text.clearEntities()},tick:function(e){e.input.isMouseDown()&&e.switchToState("gameSetup")}})},4693:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.PowerHandler=void 0;var i=function(e){function t(){var t=e.call(this,"PowerHandler")||this;return t.time=0,t}return o(t,e),t.activatePower=function(e,r){t.activePower=e,e.activate(r)},t.deactivatePower=function(e){var r;null===(r=t.activePower)||void 0===r||r.deactivate(e),t.activePower=null},t.isPowerActive=function(){return!!this.activePower},t.activePowerName=function(){var e,t;return null!==(t=null===(e=this.activePower)||void 0===e?void 0:e.name)&&void 0!==t?t:""},t.prototype.tick=function(e,r){t.activePower&&(this.time+=r,this.time>=t.activePower.timeout&&(this.time=0,t.deactivatePower(e)))},t.activePower=null,t}(r(9323).System);t.PowerHandler=i}},s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}};return a[e].call(r.exports,r,r.exports,c),r.exports}e=c(9323),t=c(1282),r=c(8265),n=c(2131),o=c(4978),(i=new e.Game({canvasDimensions:new e.Vec2(1024,768),controlScheme:"mouse"})).registerShader(e.ShaderPrograms.BASIC),i.registerShader(e.ShaderPrograms.TEXTURE_COLORED),i.setData("wallSize",20),i.setData("brickRows",8),i.setData("brickColumns",10),i.setData("brickPadding",10),i.setData("brickMargin",75),i.setData("level",1),i.canvas.style.cursor="none",i.addStates(n.MENU_STATE,o.GAME_SETUP_STATE,r.GAME_STATE,t.GAME_OVER_STATE),i.start(n.MENU_STATE.name)})();